<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة تحكم التاجر - VIRA MALL</title>
<style>
body{margin:0; font-family:'Segoe UI', Tahoma, sans-serif; background:#f5f5f7;}
h1{text-align:center; color:#D4AF37; margin:20px 0;}
.container{max-width:600px; margin:0 auto;}
input, button, textarea{width:100%; padding:10px; margin:8px 0; border-radius:8px; border:1px solid #ccc; font-size:14px;}
button{background:#D4AF37; border:none; font-weight:bold; cursor:pointer;}
table{width:90%; margin:20px auto; border-collapse:collapse; background:white; border-radius:12px; overflow:hidden;}
table th, table td{padding:8px; border:1px solid #ddd; text-align:center;}
table th{background:#D4AF37; color:#000;}
#copyLinksBtn, #downloadCSVBtn{margin:10px; padding:10px 15px; border:none; border-radius:8px; background:#0f1111; color:#D4AF37; cursor:pointer; font-weight:bold;}
.hidden{display:none;}
</style>
</head>
<body>

<h1>لوحة تحكم التاجر - VIRA MALL</h1>

<!-- صفحة التسجيل / تسجيل الدخول -->
<div class="container" id="authSection">
  <h2 style="text-align:center">تسجيل الدخول / تسجيل حساب جديد</h2>
  <input type="text" id="username" placeholder="اسم المستخدم">
  <input type="password" id="password" placeholder="كلمة المرور">
  <button id="loginBtn">تسجيل / دخول</button>
  <p style="text-align:center; font-size:12px;">كل التاجرات سيظهر لهم منتجاتهم فقط</p>
</div>

<!-- لوحة التحكم -->
<div class="container hidden" id="adminSection">
  <h2 style="text-align:center">إضافة منتج جديد</h2>
  <input type="text" id="productName" placeholder="اسم المنتج">
  <textarea id="productDesc" placeholder="وصف المنتج"></textarea>
  <input type="text" id="productPrice" placeholder="السعر">
  <input type="text" id="productStore" placeholder="اسم المتجر">
  <input type="text" id="productImg" placeholder="رابط الصورة (يمكن متعدد مفصول بمسافة)">
  <input type="text" id="productWhatsApp" placeholder="رابط واتساب">
  <input type="text" id="productSale" placeholder="التخفيض (اختياري)">
  <button id="uploadBtn">رفع المنتج</button>

  <h2 style="text-align:center">المنتجات المضافة</h2>
  <table id="productsTable">
    <thead>
      <tr>
        <th>الاسم</th><th>الوصف</th><th>السعر</th><th>المتجر</th><th>رابط الصورة</th><th>واتساب</th><th>تخفيض</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button id="copyLinksBtn">نسخ جميع روابط الصور</button>
  <button id="downloadCSVBtn">تحميل CSV</button>
</div>

<script>
let uploadedProducts=[];

// ✅ نظام تسجيل الدخول البسيط (LocalStorage)
document.getElementById('loginBtn').addEventListener('click',()=>{
  const username=document.getElementById('username').value.trim();
  const password=document.getElementById('password').value.trim();
  if(!username || !password){ alert('أكمل كل الحقول'); return; }

  // حفظ بيانات المستخدم في localStorage
  localStorage.setItem('currentUser', JSON.stringify({username,password}));
  showAdminSection();
});

function showAdminSection(){
  document.getElementById('authSection').classList.add('hidden');
  document.getElementById('adminSection').classList.remove('hidden');
}

// تحقق إذا كان المستخدم مسجل بالفعل
if(localStorage.getItem('currentUser')){
  showAdminSection();
}

// رفع المنتجات
document.getElementById('uploadBtn').addEventListener('click',()=>{
  const name=document.getElementById('productName').value.trim();
  const desc=document.getElementById('productDesc').value.trim();
  const price=document.getElementById('productPrice').value.trim();
  const store=document.getElementById('productStore').value.trim();
  const img=document.getElementById('productImg').value.trim();
  const whatsapp=document.getElementById('productWhatsApp').value.trim();
  const sale=document.getElementById('productSale').value.trim();

  if(!name || !price || !store || !img || !whatsapp){ alert('أكمل الحقول المطلوبة'); return; }

  const row=document.createElement('tr');
  row.innerHTML=`<td>${name}</td><td>${desc}</td><td>${price}</td><td>${store}</td><td><a href="${img}" target="_blank">${img}</a></td><td>${whatsapp}</td><td>${sale}</td>`;
  document.querySelector('#productsTable tbody').appendChild(row);

  uploadedProducts.push({name,desc,price,store,img,whatsapp,sale});

  // مسح الإدخالات
  document.getElementById('productName').value='';
  document.getElementById('productDesc').value='';
  document.getElementById('productPrice').value='';
  document.getElementById('productStore').value='';
  document.getElementById('productImg').value='';
  document.getElementById('productWhatsApp').value='';
  document.getElementById('productSale').value='';
});

// نسخ روابط الصور
document.getElementById('copyLinksBtn').addEventListener('click',()=>{
  if(uploadedProducts.length===0){alert('لا توجد روابط للنسخ'); return;}
  const text=uploadedProducts.map(p=>p.img).join('\n');
  navigator.clipboard.writeText(text).then(()=>alert('تم نسخ جميع الروابط'));
});

// تحميل CSV
document.getElementById('downloadCSVBtn').addEventListener('click',()=>{
  if(uploadedProducts.length===0){alert('لا توجد منتجات لتحويلها CSV'); return;}
  const headers=["الاسم","الوصف","السعر","المتجر","رابط الصورة","واتساب","تخفيض"];
  const rows=uploadedProducts.map(p=>[p.name,p.desc,p.price,p.store,p.img,p.whatsapp,p.sale]);
  let csv=headers.join(",")+"\n";
  rows.forEach(r=>{csv+=r.map(f=>`"${f}"`).join(",")+"\n";});
  const blob=new Blob([csv],{type:'text/csv;charset=utf-8;'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='products.csv';
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
});
</script>

</body>
</html>
