<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIRA MALL | Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</title>
<style>
:root{--gold:#D4AF37;--dark:#0f1111;--gray:#f5f5f7;--white:#fff}
*{box-sizing:border-box}
body{margin:0;font-family:'Segoe UI',Tahoma,sans-serif;background:var(--gray);overflow-x:hidden}

/* Ù‡ÙŠØ¯Ø± Ù…Ø·ÙˆØ± Ù…Ø¹ Ø²Ø± Ø§Ù„Ù…Ù†ÙŠÙˆ */
header{background:var(--dark);color:white;padding:15px;text-align:center;position:sticky;top:0;z-index:1000;border-bottom:3px solid var(--gold)}
header h1{margin:0;font-size:28px;color:var(--gold)}
.menu-btn { position: absolute; top: 18px; right: 20px; font-size: 26px; color: var(--gold); cursor: pointer; }

/* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
.sidebar { height: 100%; width: 0; position: fixed; z-index: 10001; top: 0; right: 0; background: var(--dark); overflow-x: hidden; transition: 0.4s; padding-top: 60px; box-shadow: -5px 0 15px rgba(0,0,0,0.5); }
.sidebar .closebtn { position: absolute; top: 10px; left: 25px; font-size: 36px; color: var(--gold); text-decoration: none; }
.sidebar-content { padding: 20px; color: white; }
.sidebar-section { border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 15px; }
.sidebar-section h3 { color: var(--gold); margin-bottom: 10px; font-size: 18px; }
.admin-btn { background: var(--gold); color: var(--dark); border: none; width: 100%; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; }

.container{padding:15px;display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:15px;max-width:1200px;margin:0 auto}
.card{background:var(--white);border-radius:15px;overflow:hidden;box-shadow:0 4px 12px rgba(0,0,0,.08);position:relative;transition:.3s}
.card:hover{transform:translateY(-5px)}

/* Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„Ù…Ø¸Ø¨ÙˆØ· */
.slider-container{position:relative;width:100%;height:220px;overflow:hidden;background:#eee}
.slider-track{display:flex;transition:transform .4s cubic-bezier(0.4, 0, 0.2, 1);height: 100%;}
.slider-track img{min-width:100%; width:100%;height:100%;object-fit:cover}

.nav-btn{position:absolute;top:50%;transform:translateY(-50%);background:rgba(0,0,0,.4);color:white;border:none;padding:8px 10px;cursor:pointer;border-radius:50%;font-weight:bold;z-index:5; font-size: 14px;}
.next{right:5px}.prev{left:5px}

.info{padding:12px;text-align:center}
.store{font-size:10px;color:var(--gold);font-weight:bold;margin-bottom:3px}
.title{font-weight:bold;color:var(--dark);height:36px;overflow:hidden;margin:2px 0; font-size: 14px;}
.price{font-size:17px;font-weight:800;color:#222;margin-bottom:10px}
.btn-add{background:var(--gold);color:var(--dark);border:none;width:100%;padding:10px;border-radius:8px;cursor:pointer;font-weight:bold;transition:.3s}

#viewer{display:none;position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:99999;align-items:center;justify-content:center}
#viewer img{max-width:95%;max-height:90%;border-radius:12px;border:2px solid var(--gold)}
</style>
</head>
<body>

<header>
<div class="menu-btn" onclick="toggleNav(260)">â˜°</div>
<h1>VIRA MALL</h1>
<p style="margin:5px 0 0;font-size:14px;color:#eee">Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³ÙˆØ¯Ø§Ù† ğŸ‡¸ğŸ‡©</p>
</header>

<div id="mySidebar" class="sidebar">
  <a href="javascript:void(0)" class="closebtn" onclick="toggleNav(0)">Ã—</a>
  <div class="sidebar-content">
      <div class="sidebar-section">
          <h3>ğŸ’³ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹</h3>
          <p>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ§Ø¬Ø±Ø§Øª: <br><strong style="font-size:18px; color:var(--gold)">2280384</strong></p>
      </div>
      <div class="sidebar-section">
          <h3>ğŸšš Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
          <p>ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ø¹Ø± Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© ÙˆØ§Ù„Ù…ØªØ¬Ø±.</p>
      </div>
      <div class="sidebar-section">
          <h3>ğŸ‘©â€ğŸ’¼ Ø±ÙƒÙ† Ø§Ù„ØªØ¬Ø§Ø±</h3>
          <p>Ø®Ø§Øµ Ø¨Ø§Ù„ØªØ§Ø¬Ø±Ø§Øª Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©.</p>
          <button class="admin-btn" onclick="window.location.href='admin.html'">Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… âœ¨</button>
      </div>
  </div>
</div>

<div class="container" id="grid"></div>

<div id="viewer" onclick="this.style.display='none'">
<img id="viewerImg">
</div>

<script>
const SHEET_URL='https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?gid=0&single=true&output=csv';

function toggleNav(width) { document.getElementById("mySidebar").style.width = width + "px"; }

async function loadProducts(){
  try {
    const res = await fetch(SHEET_URL);
    const text = await res.text();
    const rows = text.split(/\r?\n/).slice(1);
    const products = rows.map((r, idx)=>{
      const c = r.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(x=>x.replace(/"/g,'').trim());
      // ÙØ­Øµ Ø§Ù„ØµÙˆØ±: Ù„Ùˆ ÙÙŠ Ù…Ø³Ø§ÙØ© Ø£Ùˆ ÙØ§ØµÙ„Ø© Ø¨Ù†Ø­ÙˆÙ„Ù‡Ù… Ù„Ù…ØµÙÙˆÙØ©
      let imgData = c[3] || 'https://via.placeholder.com/200';
      const imgs = imgData.includes(' ') ? imgData.split(' ') : imgData.split(',');
      
      return { id:idx, name:c[0], price:c[1], store:c[2], imgs:imgs, whatsapp:c[4] };
    }).filter(p=>p.name && !p.name.includes('!'));

    document.getElementById('grid').innerHTML = products.map(p=>{
      const imagesHtml = p.imgs.map(img=>`<img src="${img.trim()}" onclick="openImg('${img.trim()}')" onerror="this.src='https://via.placeholder.com/200'">`).join('');
      const navButtons = p.imgs.length>1 ? `<button class="nav-btn next" onclick="move(this,1)">â¯</button><button class="nav-btn prev" onclick="move(this,-1)">â®</button>`:'';
      
      return `<div class="card" data-idx="0">
        <div class="slider-container">
            <div class="slider-track">${imagesHtml}</div>
            ${navButtons}
        </div>
        <div class="info">
          <div class="store">âœ¨ ${p.store}</div>
          <div class="title">${p.name}</div>
          <div class="price">${p.price} SDG</div>
          <button class="btn-add" onclick="order('${p.whatsapp}','${p.name}')">Ø§Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ âœ…</button>
        </div>
      </div>`;
    }).join('');
  } catch(e) { console.error("Error loading products"); }
}

function move(btn, dir) {
  const card = btn.closest('.card');
  const track = card.querySelector('.slider-track');
  const total = track.querySelectorAll('img').length;
  let current = parseInt(card.getAttribute('data-idx'));
  
  current = (current + dir + total) % total;
  card.setAttribute('data-idx', current);
  // Ø§Ù„ØªØ­Ø±ÙŠÙƒ Ø¨Ù†Ø³Ø¨Ø© 100% Ù„ÙƒÙ„ ØµÙˆØ±Ø©
  track.style.transform = `translateX(${current * 100}%)`;
}

function openImg(src){document.getElementById('viewerImg').src=src;document.getElementById('viewer').style.display='flex'}
function order(num,name){window.open(`https://wa.me/${num.replace(/\s/g,'')}?text=${encodeURIComponent('Ø³Ù„Ø§Ù…Ø§Øª ÙÙŠØ±Ø§ Ù…ÙˆÙ„ØŒ Ø£Ø±ÙŠØ¯ Ø·Ù„Ø¨: '+name)}`,'_blank')}

loadProducts();
</script>
</body>
</html>
