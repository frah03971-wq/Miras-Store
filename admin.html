<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ููุญุฉ ุชุญูู ุงูุชุงุฌุฑ - VIRA MALL</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<h1>ููุญุฉ ุชุญูู ุงูุชุงุฌุฑ - VIRA MALL</h1>

<div class="upload-section">
  <input type="file" id="imageInput" accept="image/*">
  <input type="text" id="productName" placeholder="ุงุณู ุงูููุชุฌ">
  <input type="text" id="productColor" placeholder="ููู ุงูููุชุฌ">
  <input type="text" id="productDesc" placeholder="ูุตู ุงูููุชุฌ">
  <input type="text" id="productPrice" placeholder="ุงูุณุนุฑ">
  <input type="text" id="productSize" placeholder="ุงูููุงุณ">
  <input type="text" id="productEmbroidery" placeholder="ุงูุชุทุฑูุฒ">
  <button id="uploadBtn">ุฑูุน ุงูููุชุฌ</button>
</div>

<h2>ุงูููุชุฌุงุช ุงููุฑููุนุฉ</h2>
<table border="1" id="productsTable">
<thead>
<tr>
<th>ุงุณู ุงูููุชุฌ</th>
<th>ุงูููู</th>
<th>ุงููุตู</th>
<th>ุงูุณุนุฑ</th>
<th>ุงูููุงุณ</th>
<th>ุงูุชุทุฑูุฒ</th>
<th>ุฑุงุจุท ุงูุตูุฑุฉ</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button id="copyLinksBtn">ูุณุฎ ุฌููุน ุงูุฑูุงุจุท</button>
<button id="downloadCSVBtn">ุชุญููู CSV</button>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<script>
  // ๐น ุฅุนุฏุงุฏุงุช Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBOcv6Feaq63nE3P1YH72-q--xZ1GF3xEA",
    authDomain: "vira-mall.firebaseapp.com",
    projectId: "vira-mall",
    storageBucket: "vira-mall.appspot.com",
    messagingSenderId: "504385201131",
    appId: "1:504385201131:web:af56a81e75630b76b12fae",
    measurementId: "G-71TTJFB4KN"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const storage = firebase.storage();

  const imageInput = document.getElementById('imageInput');
  const uploadButton = document.getElementById('uploadBtn');
  const productNameInput = document.getElementById('productName');
  const productColorInput = document.getElementById('productColor');
  const productDescInput = document.getElementById('productDesc');
  const productPriceInput = document.getElementById('productPrice');
  const productSizeInput = document.getElementById('productSize');
  const productEmbroideryInput = document.getElementById('productEmbroidery');
  const tableBody = document.getElementById('productsTable').querySelector('tbody');
  const copyLinksBtn = document.getElementById('copyLinksBtn');
  const downloadCSVBtn = document.getElementById('downloadCSVBtn');

  const uploadedProducts = [];

  uploadButton.addEventListener('click', () => {
    const file = imageInput.files[0];
    if(!file){ alert('ุงุฎุชุงุฑู ุตูุฑุฉ ููููุชุฌ'); return; }

    const name = productNameInput.value || "ุจุฏูู ุงุณู";
    const color = productColorInput.value || "-";
    const desc = productDescInput.value || "-";
    const price = productPriceInput.value || "-";
    const size = productSizeInput.value || "-";
    const embroidery = productEmbroideryInput.value || "-";

    const storageRef = storage.ref('products/' + file.name);
    storageRef.put(file).then(snapshot => {
      snapshot.ref.getDownloadURL().then(url => {
        // ุฅุถุงูุฉ ููุฌุฏูู
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${name}</td>
          <td>${color}</td>
          <td>${desc}</td>
          <td>${price}</td>
          <td>${size}</td>
          <td>${embroidery}</td>
          <td><a href="${url}" target="_blank">${url}</a></td>
        `;
        tableBody.appendChild(row);

        // ุญูุธ ุงูููุชุฌ ูููุณุฎ ุฃู CSV
        uploadedProducts.push({name,color,desc,price,size,embroidery,url});

        // ูุณุญ ุงูุฅุฏุฎุงูุงุช
        imageInput.value = '';
        productNameInput.value = '';
        productColorInput.value = '';
        productDescInput.value = '';
        productPriceInput.value = '';
        productSizeInput.value = '';
        productEmbroideryInput.value = '';
      });
    }).catch(err => { console.error(err); alert('ุฎุทุฃ ูู ุงูุฑูุน'); });
  });

  // ูุณุฎ ุฌููุน ุงูุฑูุงุจุท
  copyLinksBtn.addEventListener('click', () => {
    if(uploadedProducts.length === 0){ alert('ูุง ุชูุฌุฏ ุฑูุงุจุท ูููุณุฎ'); return; }
    const text = uploadedProducts.map(p => p.url).join('\n');
    navigator.clipboard.writeText(text).then(()=>alert('ุชู ูุณุฎ ุฌููุน ุงูุฑูุงุจุท'));
  });

  // ุชุญููู CSV
  downloadCSVBtn.addEventListener('click', () => {
    if(uploadedProducts.length === 0){ alert('ูุง ุชูุฌุฏ ููุชุฌุงุช ูุชุญููููุง CSV'); return; }
    const headers = ["ุงุณู ุงูููุชุฌ","ุงูููู","ุงููุตู","ุงูุณุนุฑ","ุงูููุงุณ","ุงูุชุทุฑูุฒ","ุฑุงุจุท ุงูุตูุฑุฉ"];
    const rows = uploadedProducts.map(p => [p.name,p.color,p.desc,p.price,p.size,p.embroidery,p.url]);
    let csv = headers.join(",") + "\n";
    rows.forEach(r => { csv += r.map(f => `"${f}"`).join(",") + "\n"; });
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download='products.csv';
    document.body.appendChild(a); a.click(); document.body.removeChild(a);
  });
</script>

</body>
</html>
