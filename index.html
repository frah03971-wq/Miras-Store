<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIRA MALL | ÙÙŠØ±Ø§ Ù…ÙˆÙ„</title>

<style>
:root{--gold:#D4AF37;--dark:#0f1111;--gray:#f5f5f7;--white:#fff}
body{margin:0;font-family:'Segoe UI',Tahoma;background:var(--gray);overflow-x:hidden}

header{
background:var(--dark);
color:white;
padding:15px;
text-align:center;
position:sticky;
top:0;
z-index:1000;
border-bottom:3px solid var(--gold);
display:flex;
align-items:center;
justify-content:space-between
}
header h1{margin:0;color:var(--gold);font-size:24px;flex:1}

.menu-btn{font-size:28px;color:var(--gold);cursor:pointer}

.container{
padding:15px;
display:grid;
grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
gap:15px;
max-width:1200px;
margin:auto
}

.card{
background:white;
border-radius:15px;
overflow:hidden;
box-shadow:0 4px 12px rgba(0,0,0,.08)
}

/* ===== SLIDER ===== */
.slider{
position:relative;
height:210px;
overflow:hidden;
direction:ltr;
background:#eee
}
.track{
display:flex;
height:100%;
transition:transform .4s ease
}
.track img{
width:100%;
flex-shrink:0;
object-fit:cover
}
.nav{
position:absolute;
top:50%;
transform:translateY(-50%);
width:28px;
height:28px;
border-radius:50%;
background:rgba(0,0,0,.5);
color:white;
border:none;
cursor:pointer;
z-index:10
}
.prev{left:6px}
.next{right:6px}

.dots{
position:absolute;
bottom:6px;
left:50%;
transform:translateX(-50%);
display:flex;
gap:4px
}
.dot{
width:6px;
height:6px;
border-radius:50%;
background:rgba(255,255,255,.6)
}
.dot.active{background:var(--gold);width:12px;border-radius:10px}

/* INFO */
.info{padding:12px;text-align:center}
.store{font-size:10px;color:var(--gold);font-weight:bold}
.title{font-size:14px;font-weight:bold;height:38px;overflow:hidden;margin:6px 0}
.price{font-size:17px;font-weight:900;margin-bottom:10px}
.btn{
background:var(--gold);
border:none;
padding:10px;
border-radius:10px;
font-weight:bold;
width:100%;
cursor:pointer
}
</style>
</head>

<body>

<header>
<div style="width:40px"></div>
<h1>VIRA MALL</h1>
<div class="menu-btn">â˜°</div>
</header>

<div class="container" id="grid">
<p style="grid-column:1/-1;text-align:center;color:#777;padding:40px">
Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øªâ€¦
</p>
</div>

<script>
/* ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ø´ÙŠØª */
const SHEET_URL =
'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?output=csv';

async function fetchProducts(){
 try{
  const res = await fetch(SHEET_URL + '&_=' + Date.now());
  const text = await res.text();

  const rows = text
   .replace(/\uFEFF/g,'')
   .split(/\r?\n/)
   .slice(1);

  const products = rows.map((row,i)=>{
   const c = row
    .split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/)
    .map(x=>x.replace(/"/g,'').trim());

   if(!c[0] || c[0].length<2) return null;

   return{
    id:i,
    name:c[0],
    price:c[1]||'0',
    store:c[2]||'VIRA',
    imgs:c[3]
      ? c[3].split(/[ ,]+/).filter(x=>x.startsWith('http'))
      : [],
    wa:c[4]||'249000000000'
   };
  }).filter(Boolean);

  render(products);
 }
 catch(e){
  document.getElementById('grid').innerHTML =
  '<p style="grid-column:1/-1;color:red;text-align:center">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>';
 }
}

function render(list){
 const grid=document.getElementById('grid');

 grid.innerHTML = list.map(p=>{
  const imgs = p.imgs.length
   ? p.imgs
   : ['https://via.placeholder.com/300x300?text=VIRA+MALL'];

  const dots = imgs.map((_,i)=>
   `<div class="dot ${i==0?'active':''}"></div>`
  ).join('');

  return `
  <div class="card" data-i="0">
   <div class="slider">
    <div class="track">
     ${imgs.map(img=>`<img src="${img}">`).join('')}
    </div>

    ${imgs.length>1?`
     <button class="nav prev" onclick="slide(this,-1)">â®</button>
     <button class="nav next" onclick="slide(this,1)">â¯</button>
     <div class="dots">${dots}</div>
    `:''}
   </div>

   <div class="info">
    <div class="store">âœ¨ ${p.store}</div>
    <div class="title">${p.name}</div>
    <div class="price">${p.price} SDG</div>
    <button class="btn"
     onclick="window.open('https://wa.me/${p.wa}?text=Ø·Ù„Ø¨: ${p.name}')">
     Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨
    </button>
   </div>
  </div>`;
 }).join('');

 autoSlide();
}

function slide(btn,dir){
 const card = btn.closest('.card');
 const track = card.querySelector('.track');
 const dots = card.querySelectorAll('.dot');
 const total = track.children.length;
 let i = +card.dataset.i;

 i = (i + dir + total) % total;
 card.dataset.i = i;
 track.style.transform = `translateX(-${i*100}%)`;

 dots.forEach(d=>d.classList.remove('active'));
 if(dots[i]) dots[i].classList.add('active');
}

function autoSlide(){
 setInterval(()=>{
  document.querySelectorAll('.card').forEach(card=>{
   const next = card.querySelector('.next');
   if(next) slide(next,1);
  });
 },5000);
}

fetchProducts();
</script>

</body>
</html>
