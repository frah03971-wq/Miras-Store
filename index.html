<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | GLOBAL</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&family=Cinzel:wght@700&display=swap');
        
        :root { --gold: #D4AF37; --black: #000; --white: #fff; --gray: #f8f8f8; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--white); font-family: 'Cairo', sans-serif; margin: 0; padding-bottom: 100px; color: #111; overflow-x: hidden; }

        /* Splash Screen */
        #splash { position: fixed; inset: 0; background: #fff; z-index: 20000; display: flex; justify-content: center; align-items: center; transition: 0.8s; }
        .v-logo { font-family: 'Cinzel', serif; font-size: 50px; color: var(--gold); letter-spacing: 10px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        /* Global Header */
        header { background: #fff; padding: 20px; text-align: center; border-bottom: 1px solid #eee; position: sticky; top: 0; z-index: 10000; }
        header h1 { margin: 0; font-family: 'Cinzel', serif; font-size: 28px; letter-spacing: 5px; color: #000; }

        /* Section Titles */
        .section-tag { padding: 30px 20px 10px; font-weight: 900; font-size: 20px; display: flex; align-items: center; gap: 10px; }
        .section-tag::after { content: ''; flex: 1; height: 1px; background: var(--gold); opacity: 0.3; }

        /* Global Grid */
        .mall-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; padding: 12px; }
        .product-card { background: #fff; border-radius: 25px; overflow: hidden; border: 1px solid #f0f0f0; position: relative; transition: 0.4s; box-shadow: 0 5px 15px rgba(0,0,0,0.02); }
        .product-card:hover { transform: translateY(-5px); border-color: var(--gold); }

        /* Image Slider & Zoom */
        .slider { width: 100%; height: 240px; display: flex; overflow-x: auto; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .slider::-webkit-scrollbar { display: none; }
        .slider img { min-width: 100%; height: 100%; object-fit: cover; scroll-snap-align: start; cursor: zoom-in; }

        .price-chip { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.8); color: var(--gold); padding: 4px 12px; border-radius: 10px; font-weight: 800; font-size: 11px; z-index: 10; border: 1px solid var(--gold); }
        
        .card-info { padding: 15px; text-align: center; }
        .store-name { font-size: 9px; color: var(--gold); font-weight: 900; letter-spacing: 1.5px; margin-bottom: 5px; display: block; }
        .prod-name { font-size: 14px; font-weight: 700; height: 38px; overflow: hidden; margin-bottom: 8px; }
        .prod-desc { font-size: 10px; color: #888; height: 30px; overflow: hidden; line-height: 1.4; margin-bottom: 12px; }

        .add-btn { background: #000; color: var(--gold); border: none; width: 100%; padding: 12px; border-radius: 15px; font-weight: 900; cursor: pointer; transition: 0.3s; font-size: 12px; }
        .add-btn:active { transform: scale(0.95); }

        /* Professional Modals */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 20000; backdrop-filter: blur(12px); }
        .modal-box { background: #fff; width: 92%; max-width: 450px; margin: 50px auto; border-radius: 35px; padding: 30px; max-height: 80vh; overflow-y: auto; position: relative; }

        /* Bank Info Box (Merchant Portal) */
        .bank-portal { background: #e3f2fd; border: 2px dashed #2196f3; padding: 25px; border-radius: 25px; text-align: center; margin-bottom: 20px; }
        .bank-portal b { font-size: 30px; display: block; margin: 10px 0; color: #0d47a1; letter-spacing: 2px; }

        /* Nav Bar - The Global V */
        nav { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); width: 85%; background: rgba(255,255,255,0.95); backdrop-filter: blur(15px); border-radius: 100px; display: flex; justify-content: space-around; align-items: center; padding: 12px; border: 1px solid #eee; z-index: 15000; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .n-btn { cursor: pointer; color: #ccc; transition: 0.3s; display: flex; flex-direction: column; align-items: center; text-decoration: none; }
        .n-btn span { font-size: 9px; font-weight: 900; margin-top: 4px; }
        .n-btn.active { color: var(--gold); }
        .v-home { background: #000; width: 60px; height: 60px; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-top: -45px; border: 4px solid #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .v-home span { font-family: 'Cinzel', serif; font-size: 30px; color: var(--gold); }

        /* Zoom Overlay */
        #zoom { display: none; position: fixed; inset: 0; background: #fff; z-index: 30000; flex-direction: column; justify-content: center; align-items: center; }
        #zoom img { width: 100%; max-height: 85vh; object-fit: contain; }
    </style>
</head>
<body>

<div id="splash"><div class="v-logo">VIRA</div></div>
<header><h1>VIRA</h1></header>

<div id="zoom" onclick="this.style.display='none'"><img src="" id="z-img"></div>

<div class="section-tag">ğŸ‘‘ VIRA EXCLUSIVE</div>
<div id="viraGrid" class="mall-grid"></div>

<div class="section-tag">ğŸŒ GLOBAL PARTNERS</div>
<div id="otherGrid" class="mall-grid"></div>

<div id="cartM" class="modal"><div class="modal-box">
    <h2 style="text-align:center;">Ø­Ù‚ÙŠØ¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ğŸ›’</h2>
    <div id="cartContent"></div>
    <div style="text-align:center; padding-top:20px; border-top:1px solid #eee;">
        <h1 id="cartTotal">0 SDG</h1>
        <p style="font-size:11px; color:var(--gold); font-weight:bold;">* ÙŠØªÙ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªÙˆØµÙŠÙ„ Ù…Ø¹ ÙƒÙ„ ØªØ§Ø¬Ø± Ø¹Ù„Ù‰ Ø­Ø¯Ø©.</p>
        <button class="add-btn" style="padding:15px;" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <button onclick="closeM('cartM')" style="margin-top:15px; color:red; border:none; background:none; font-weight:700;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div></div>

<div id="joinM" class="modal"><div class="modal-box">
    <h2 style="text-align:center; color:var(--gold);">Ø§Ù†Ø¶Ù…ÙŠ Ù„Ø¹Ø§Ù„Ù… VIRA ğŸ‘‘</h2>
    <div class="bank-portal">
        <p style="margin:0; font-size:14px;">Ø­Ø³Ø§Ø¨ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø± (Ø¨Ù†ÙƒÙƒ):</p>
        <b>2280384</b>
        <p style="font-size:11px; margin:0;">Ø¨Ø§Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© VIRA MALL OFFICIAL</p>
    </div>
    <input type="text" id="storeN" placeholder="Ø§Ø³Ù… Ù…ØªØ¬Ø±Ùƒ" style="width:100%; padding:15px; border-radius:15px; border:1px solid #eee; margin-bottom:10px; font-family:'Cairo';">
    <p style="font-size:11px; color:#888; text-align:center;">Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„: 30,000 SDG Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©.</p>
    <button class="add-btn" style="padding:15px;" onclick="merchantAction()">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</button>
    <button onclick="closeM('joinM')" style="margin-top:15px; color:red; border:none; background:none; width:100%;">Ø¥ØºÙ„Ø§Ù‚</button>
</div></div>

<nav>
    <div class="n-btn active" onclick="location.reload()">ğŸ <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></div>
    <div class="n-btn" onclick="openM('cartM')">ğŸ›’<span>Ø§Ù„Ø³Ù„Ø©</span></div>
    <div class="v-home" onclick="window.scrollTo({top:0, behavior:'smooth'})"><span>V</span></div>
    <div class="n-btn" onclick="openM('joinM')">ğŸ‘‘<span>Ø§Ù†Ø¶Ù…</span></div>
    <div class="n-btn">â¤ï¸<span>Ø§Ù„Ù…ÙØ¶Ù„Ø©</span></div>
</nav>

<script>
    const SHEET_ID = '1UZnlp45dVMRJxNibcg3fm52H6S4DB4YbGLr4KK3jPqs';
    let fullDB = []; let cart = [];

    window.onload = () => { setTimeout(() => { document.getElementById('splash').style.opacity = '0'; setTimeout(()=>document.getElementById('splash').remove(), 800); }, 1500); };

    async function loadMall() {
        const [r1, r2] = await Promise.all([
            fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`),
            fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=1152504859`)
        ]);
        const d1 = await r1.text(); const d2 = await r2.text();
        
        const parse = (csv, isV) => {
            const rows = csv.split('\n').map(l => l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/));
            const h = rows[0].map(x => x.replace(/"/g,'').trim());
            return rows.slice(1).map(c => {
                const get = (k) => { const i = h.findIndex(x => x.includes(k)); return i!==-1?c[i]?.replace(/"/g,'').trim():''; };
                const rawImg = isV ? c[3] : get('Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©');
                return {
                    name: isV ? c[0] : (get('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬') || get('Ø§Ù„Ù…Ù†ØªØ¬')),
                    price: isV ? c[1] : (get('Ø§Ù„Ø³Ø¹Ø±') || get('Ù‚ÙŠÙ…Ø©')),
                    store: isV ? (c[2]||'VIRA') : (get('Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±')||'Ù…ØªØ¬Ø± Ø´Ø±ÙŠÙƒ'),
                    desc: isV ? (c[4]||'') : (get('Ø§Ù„ÙˆØµÙ')||'Ù‚Ø·Ø¹Ø© Ù…Ø®ØªØ§Ø±Ø© Ø¨Ø¹Ù†Ø§ÙŠØ©'),
                    imgs: rawImg ? rawImg.split(/[;,]/).map(s => s.trim()) : []
                };
            }).filter(p => p.name && p.imgs.length > 0);
        };

        fullDB = [...parse(d1, true), ...parse(d2, false)];
        renderItems(fullDB);
    }

    function renderItems(data) {
        let vH = '', oH = '';
        data.forEach((p, i) => {
            const card = `<div class="product-card">
                <div class="price-chip">${p.price}</div>
                <div class="slider">
                    ${p.imgs.map(img => `<img src="${img}" onclick="zoomImg('${img}')" loading="lazy">`).join('')}
                </div>
                <div class="card-info">
                    <span class="store-name">${p.store}</span>
                    <div class="prod-name">${p.name}</div>
                    <div class="prod-desc">${p.desc}</div>
                    <button class="add-btn" onclick="add(${i})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
                </div>
            </div>`;
            if(p.store.toLowerCase().includes('vira') || p.store.includes('ÙÙŠØ±Ø§')) vH += card;
            else oH += card;
        });
        document.getElementById('viraGrid').innerHTML = vH;
        document.getElementById('otherGrid').innerHTML = oH;
    }

    function zoomImg(src) { document.getElementById('z-img').src = src; document.getElementById('zoom').style.display = 'flex'; }
    function add(i) { cart.push(fullDB[i]); updateCart(); alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ¨'); }

    function updateCart() {
        const groups = cart.reduce((acc, obj) => { acc[obj.store] = acc[obj.store] || []; acc[obj.store].push(obj); return acc; }, {});
        document.getElementById('cartContent').innerHTML = Object.keys(groups).map(s => `
            <div style="background:#f9f9f9; padding:15px; border-radius:20px; margin-bottom:10px; border-right:5px solid var(--gold);">
                <div style="font-weight:900; color:var(--gold); font-size:13px;">Ø§Ù„Ù…ØªØ¬Ø±: ${s}</div>
                ${groups[s].map(item => `<div style="display:flex; justify-content:space-between; font-size:13px; margin-top:5px;"><span>${item.name}</span><b>${item.price}</b></div>`).join('')}
            </div>
        `).join('');
        const total = cart.reduce((a,i) => a + (parseInt(i.price.replace(/[^0-9]/g,''))||0), 0);
        document.getElementById('cartTotal').innerText = `${total.toLocaleString()} SDG`;
    }

    function sendOrder() {
        if(!cart.length) return;
        const msg = encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† VIRA MALL ğŸ‘‘\n\n${cart.map(i=>`â€¢ ${i.name} [${i.store}]`).join('\n')}\n\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('cartTotal').innerText}\n\n*ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ù„Ù„ØªÙˆØµÙŠÙ„.*`);
        window.open(`https://wa.me/249967584275?text=${msg}`);
    }

    function merchantAction() {
        const n = document.getElementById('storeN').value;
        if(!n) return alert('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±');
        const msg = encodeURIComponent(`Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù… Ù…ØªØ¬Ø± Ø¬Ø¯ÙŠØ¯ ğŸ‘‘\n\nØ§Ù„Ù…ØªØ¬Ø±: ${n}\n*ØªÙ… ØªØ­ÙˆÙŠÙ„ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙØ¹ÙŠÙ„ (30,000 SDG) Ù„Ø­Ø³Ø§Ø¨ 2280384*`);
        window.open(`https://wa.me/249967584275?text=${msg}`);
    }

    function openM(id) { document.getElementById(id).style.display = 'block'; }
    function closeM(id) { document.getElementById(id).style.display = 'none'; }

    loadMall();
</script>
</body>
</html>
