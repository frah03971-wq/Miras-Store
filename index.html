<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | Ø±Ø¯ÙˆØ¯ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</title>
    <style>
        :root { --gold: #D4AF37; --black: #0a0a0a; --bg: #f8f9fa; }
        body { margin: 0; font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); color: var(--black); overflow-x: hidden; }

        /* Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ */
        header { background: var(--black); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 2000; }
        header h1 { color: var(--gold); margin: 0; font-size: 20px; letter-spacing: 2px; }
        .menu-btn { cursor: pointer; color: var(--gold); font-size: 24px; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(165px, 1fr)); gap: 12px; padding: 12px; max-width: 1200px; margin: 0 auto; }

        /* ÙƒØ±Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ */
        .card { background: white; border-radius: 18px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); position: relative; display: flex; flex-direction: column; transition: 0.3s; }
        
        .slider { position: relative; width: 100%; aspect-ratio: 1/1.2; background: #eee; overflow: hidden; direction: ltr!important; }
        .track { display: flex; height: 100%; transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .track img { min-width: 100%; object-fit: cover; }

        .fav { position: absolute; top: 10px; right: 10px; z-index: 10; color: rgba(255,255,255,0.8); font-size: 20px; cursor: pointer; text-shadow: 0 0 5px rgba(0,0,0,0.3); }
        .fav.active { color: #e41e31; }

        .info { padding: 10px; text-align: center; }
        .store { color: var(--gold); font-size: 10px; font-weight: bold; }
        .title { font-size: 13px; font-weight: bold; height: 34px; overflow: hidden; margin: 4px 0; color: #333; }
        .price { font-size: 16px; font-weight: 900; color: var(--black); }

        .btn { background: var(--black); color: white; width: 100%; border: none; padding: 10px; border-radius: 10px; font-weight: bold; margin-top: 8px; cursor: pointer; text-decoration: none; display: block; font-size: 12px; }

        /* Ø§Ù„Ù…Ù†ÙŠÙˆ */
        .sidebar { position: fixed; top: 0; right: -100%; width: 280px; height: 100%; background: white; z-index: 3000; transition: 0.4s; padding: 25px; box-shadow: -5px 0 15px rgba(0,0,0,0.1); }
        .sidebar.active { right: 0; }
        .side-item { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .side-item h3 { font-size: 16px; color: var(--gold); margin-bottom: 5px; }
        .side-item p { font-size: 13px; color: #666; margin: 0; }
    </style>
</head>
<body>

<header>
    <div style="width:30px"></div>
    <h1>VIRA MALL</h1>
    <div class="menu-btn" onclick="toggleMenu()">â˜°</div>
</header>

<div class="grid" id="grid">
    <p style="text-align:center; grid-column:1/-1; padding-top:50px; color:#888;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø¨Ø¯Ø§Ø¹Ø§Øª Ø§Ù„ØªØ§Ø¬Ø±Ø§Øª... âœ¨</p>
</div>

<div class="sidebar" id="sidebar">
    <div style="font-size:24px; cursor:pointer; margin-bottom:20px" onclick="toggleMenu()">âœ•</div>
    <div class="side-item">
        <h3>ğŸšš Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
        <p>Ù„ÙƒÙ„ ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ØŒ Ø§Ù„Ø³Ø¹Ø± Ø­Ø³Ø¨ Ø§Ù„Ù…ØªØ¬Ø±.</p>
    </div>
    <div class="side-item">
        <h3>ğŸ’³ Ø§Ù„Ø¯ÙØ¹ (Ø¨Ù†ÙƒÙƒ)</h3>
        <p>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: <strong>2280384</strong></p>
    </div>
    <div class="side-item">
        <h3>âœˆï¸ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</h3>
        <a href="https://t.me/+VksKXlPLnnFjYzlk" style="text-decoration:none; color:#0088cc; font-weight:bold;">Ù‚Ù†Ø§Ø© Ø§Ù„ØªÙ„Ø¬Ø±Ø§Ù… Ø§Ù„Ø±Ø³Ù…ÙŠØ©</a>
    </div>
    <a href="admin.html" style="display:block; background:var(--gold); color:black; text-align:center; padding:12px; border-radius:10px; font-weight:bold; text-decoration:none; margin-top:20px;">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ§Ø¬Ø±Ø§Øª ğŸš€</a>
</div>

<script>
    // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù„ÙŠ ÙÙŠÙ‡ "Ø±Ø¯ÙˆØ¯ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ 1"
    const API = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?gid=0&single=true&output=csv';

    async function load() {
        try {
            const r = await fetch(API + '&t=' + Date.now());
            const t = await r.text();
            const rows = t.split(/\r?\n/).slice(1); // ØªØ¬Ø§Ù‡Ù„ ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø·ÙˆØ§Ù„ÙŠ
            
            const data = rows.map((row, idx) => {
                const c = row.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(v => v.replace(/"/g, '').trim());
                // ÙÙ„ØªØ±Ø©: Ù„Ùˆ Ø§Ù„Ø³Ø¹Ø± Ù…Ø´ Ø±Ù‚Ù… Ø£Ùˆ Ø§Ù„Ø§Ø³Ù… ÙØ§Ø¶ÙŠØŒ Ù…Ø§ ØªØ¹Ø±Ø¶Ù‡ (Ø¹Ø´Ø§Ù† Ù†Ù‚ØªÙ„ Ø§Ù„Ø¬ØºÙ…Ø³Ø©)
                if(!c[0] || isNaN(parseFloat(c[1]))) return null;
                
                return {
                    id: idx,
                    name: c[0],
                    price: c[1],
                    store: c[2] || 'VIRA STORE',
                    imgs: c[3] ? c[3].split(/\s+/).filter(i => i.startsWith('http')) : [],
                    wa: c[4] || '249'
                };
            }).filter(p => p);

            render(data);
        } catch(e) { document.getElementById('grid').innerHTML = "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª."; }
    }

    function render(items) {
        const grid = document.getElementById('grid');
        grid.innerHTML = items.map(p => `
            <div class="card" id="p-${p.id}" data-idx="0">
                <div class="slider" onclick="nextSlide(${p.id})">
                    <div class="fav" onclick="event.stopPropagation(); this.classList.toggle('active')">â¤</div>
                    <div class="track">${p.imgs.map(img => `<img src="${img}">`).join('')}</div>
                </div>
                <div class="info">
                    <span class="store">âœ¨ ${p.store}</span>
                    <div class="title">${p.name}</div>
                    <div class="price">${p.price} SDG</div>
                    <button class="btn" onclick="window.open('https://wa.me/${p.wa.replace(/\D/g,'')}?text=Ø·Ù„Ø¨: ${p.name}')">Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨ âœ…</button>
                </div>
            </div>
        `).join('');
    }

    function nextSlide(id) {
        const card = document.getElementById(`p-${id}`);
        const track = card.querySelector('.track');
        const count = track.children.length;
        if(count <= 1) return;
        let i = (parseInt(card.dataset.idx) + 1) % count;
        card.dataset.idx = i;
        track.style.transform = `translateX(-${i * 100}%)`;
    }

    function toggleMenu() { document.getElementById('sidebar').classList.toggle('active'); }

    load();
</script>
</body>
</html>
