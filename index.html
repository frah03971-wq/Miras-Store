<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>VIRA MALL | Ø§Ù„Ø±ÙØ§Ù‡ÙŠØ© Ø§Ù„Ù…Ø¬Ø±Ù‘Ø¯Ø©</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');
        
        :root {
            --gold: #D4AF37;
            --gold-light: #F1D592;
            --black: #0A0A0A;
            --glass: rgba(255, 255, 255, 0.03);
            --card-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        html, body { background: var(--black); color: #fff; font-family: 'Cairo', sans-serif; margin: 0; padding: 0; overflow-x: hidden; scroll-behavior: smooth; }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù† Ø¹Ù†Ø¯ Ø§Ù„ÙØªØ­ */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ */
        .top-nav {
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(15px);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 2000;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }

        .logo { font-size: 1.6em; font-weight: 900; color: #fff; text-decoration: none; letter-spacing: 1px; }
        .logo span { color: var(--gold); text-shadow: 0 0 10px rgba(212, 175, 55, 0.5); }

        .search-bar {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 10px 15px;
            color: #fff;
            width: 50%;
            outline: none;
            transition: 0.3s;
        }
        .search-bar:focus { border-color: var(--gold); width: 60%; }

        /* Ø¨Ø§Ù†Ø± Ø§Ù„Ø±Ø¤ÙŠØ© */
        .hero {
            padding: 40px 20px;
            background: linear-gradient(to bottom, #111, #000);
            text-align: center;
            border-bottom: 1px solid #222;
        }
        .hero h2 { font-weight: 900; font-size: 22px; color: var(--gold); margin-bottom: 15px; }
        .hero p { font-size: 14px; color: #aaa; line-height: 1.8; max-width: 400px; margin: 0 auto; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…ØªØ§Ø¬Ø± */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 20px;
            animation: fadeInUp 0.8s ease;
        }

        .shop-card {
            background: #151515;
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid #222;
            transition: 0.4s;
            position: relative;
        }
        .shop-card:active { transform: scale(0.95); }
        .shop-img { width: 100%; height: 200px; object-fit: cover; filter: brightness(0.8); }
        .shop-overlay {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 15px;
            background: linear-gradient(transparent, rgba(0,0,0,0.9));
            text-align: center;
        }
        .shop-name { font-weight: 700; font-size: 14px; color: #fff; }

        /* Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ (Ù†Ø¸Ø§Ù… iOS) */
        .modal {
            display: none;
            position: fixed;
            bottom: 0; left: 0;
            width: 100%; height: 92%;
            background: #0d0d0d;
            border-radius: 30px 30px 0 0;
            z-index: 4000;
            overflow-y: auto;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.8);
            animation: slideUp 0.4s cubic-bezier(0, 0.55, 0.45, 1);
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .close-bar { width: 40px; height: 5px; background: #333; border-radius: 10px; margin: 15px auto; }

        /* ÙƒØ±Øª Ø§Ù„Ù…Ù†ØªØ¬ */
        .p-card {
            padding: 20px;
            border-bottom: 1px solid #1a1a1a;
            animation: fadeInUp 0.5s ease;
        }
        .img-container {
            width: 100%;
            height: 350px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: var(--card-shadow);
        }
        .img-container img { width: 100%; height: 100%; object-fit: cover; }

        .p-price { font-size: 24px; font-weight: 900; color: var(--gold); margin: 15px 0; }
        .buy-btn {
            background: var(--gold);
            color: #000;
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-weight: 900;
            font-size: 16px;
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
        }

        /* Ù†Ø§Ù Ø¨Ø§Ø± Ø³ÙÙ„ÙŠ Ø°ÙƒÙŠ */
        .bottom-nav {
            position: fixed;
            bottom: 20px;
            left: 5%;
            width: 90%;
            height: 65px;
            background: rgba(20, 20, 20, 0.9);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 5000;
        }
        .nav-icon { color: #666; font-size: 20px; text-decoration: none; text-align: center; font-size: 10px; }
        .nav-icon.active { color: var(--gold); }
        .nav-icon b { display: block; font-size: 22px; margin-bottom: 2px; }

    </style>
</head>
<body>

<div class="top-nav">
    <a href="#" class="logo">VIRA<span> MALL</span></a>
    <input type="text" class="search-bar" id="mainSearch" placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙØ®Ø§Ù…Ø©..." oninput="handleSearch()">
</div>

<div class="hero">
    <h2>VIRA MALL</h2>
    <p>ØªØ¬Ø±Ø¨Ø© ØªØ³ÙˆÙ‚ ØªØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ÙˆØ¯.. Ù„Ø£Ù†ÙƒÙ ØªØ³ØªØ­Ù‚ÙŠÙ† Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø³ÙˆØ¯Ø§Ù† Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ ğŸ‡¸ğŸ‡©</p>
</div>

<div class="main-grid" id="brandsGrid">
    </div>

<div id="store-modal" class="modal">
    <div class="close-bar" onclick="closeAllModals()"></div>
    <div id="productsGrid"></div>
</div>

<nav class="bottom-nav">
    <div class="nav-icon active" onclick="closeAllModals()"><b>ğŸ </b>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
    <div class="nav-icon" onclick="openWishlist()"><b>â¤ï¸</b>Ø§Ù„Ù…ÙØ¶Ù„Ø©</div>
    <div class="nav-icon" onclick="openCart()"><b>ğŸ›ï¸</b>Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</div>
    <a href="https://wa.me/249967584275" class="nav-icon" style="color: inherit; text-decoration: none;"><b>ğŸ’¬</b>Ø§ØªØµØ§Ù„</a>
</nav>

<script>
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?output=csv';
    let allProducts = [], cart = [], wishlist = [];

    async function init() {
        try {
            const r = await fetch(sheetUrl + '&t=' + Date.now());
            const text = await r.text();
            const rows = text.split('\n').slice(1);
            allProducts = rows.map(row => {
                const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                return {
                    name: c[0]?.replace(/"/g,'').trim(),
                    price: c[1]?.replace(/"/g,'').trim(),
                    shop: c[2]?.replace(/"/g,'').trim(),
                    img: c[3]?.replace(/"/g,'').trim()
                };
            }).filter(p => p.shop);
            renderShops(allProducts);
        } catch(e) { console.error("Network Error"); }
    }

    function renderShops(data) {
        const shops = [...new Set(data.map(p => p.shop))];
        document.getElementById('brandsGrid').innerHTML = shops.map(shop => {
            const img = allProducts.find(p => p.shop === shop).img.split(',')[0];
            return `
            <div class="shop-card" onclick="openStore('${shop}')">
                <img src="${img}" class="shop-img">
                <div class="shop-overlay">
                    <div class="shop-name">${shop}</div>
                </div>
            </div>`;
        }).join('');
    }

    function openStore(name) {
        const products = allProducts.filter(p => p.shop === name);
        document.getElementById('productsGrid').innerHTML = products.map(p => `
            <div class="p-card">
                <div class="img-container">
                    <img src="${p.img.split(',')[0]}">
                </div>
                <div style="font-size:18px; font-weight:700; margin-top:15px;">${p.name}</div>
                <div class="p-price">${p.price} SDG</div>
                <button class="buy-btn" onclick="order('${p.name}')">Ø§Ù…ØªÙ„Ø§Ùƒ Ø§Ù„Ø¢Ù† ğŸ›’</button>
            </div>
        `).join('');
        document.getElementById('store-modal').style.display = 'block';
    }

    function order(item) {
        window.open(`https://wa.me/249967584275?text=${encodeURIComponent('Ø£Ù‡Ù„Ø§Ù‹ ÙÙŠØ±Ø§ Ù…ÙˆÙ„ØŒ Ø£Ø±ØºØ¨ ÙÙŠ Ø·Ù„Ø¨ Ø§Ù„ÙØ®Ø§Ù…Ø©: ' + item)}`);
    }

    function closeAllModals() { document.getElementById('store-modal').style.display = 'none'; }

    init();
</script>
</body>
</html>
