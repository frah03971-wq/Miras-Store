<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | SUPREMACY</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap');
        
        :root {
            --vira-gold: #D4AF37;
            --vira-dark: #1a1a1a;
            --bg-white: #f8f9fa;
            --card-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-white); color: var(--vira-dark); font-family: 'Cairo', sans-serif; margin: 0; overflow-x: hidden; }

        /* Splash Screen */
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff;
            z-index: 10000; display: flex; justify-content: center; align-items: center; transition: 1s;
        }
        .v-logo { font-size: 50px; font-weight: 900; color: var(--vira-gold); letter-spacing: 10px; animation: glow 2s infinite; }
        @keyframes glow { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.1); } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø£Ù…Ø§Ø²ÙˆÙ†ÙŠ */
        .v-header {
            background: #fff; padding: 20px; text-align: center; position: sticky; top: 0; z-index: 9000;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05); border-bottom: 3px solid var(--vira-gold);
        }
        .v-header h1 { margin: 0; font-weight: 900; font-size: 28px; letter-spacing: 5px; color: #000; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section-title { padding: 25px 20px 10px; font-weight: 900; font-size: 22px; display: flex; align-items: center; gap: 10px; color: #000; }
        .section-title::after { content: ''; flex: 1; height: 2px; background: var(--vira-gold); opacity: 0.3; }

        /* Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© */
        .v-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        .v-card {
            background: #fff; border-radius: 25px; overflow: hidden; position: relative;
            transition: 0.4s; border: 1px solid #eee; box-shadow: var(--card-shadow);
        }
        .v-card:hover { transform: translateY(-5px); border-color: var(--vira-gold); }
        .v-img-box { width: 100%; height: 220px; position: relative; overflow: hidden; }
        .v-img-box img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .v-price { position: absolute; bottom: 10px; left: 10px; background: #000; color: var(--vira-gold); padding: 4px 12px; border-radius: 10px; font-weight: 800; font-size: 12px; }

        .v-content { padding: 15px; text-align: center; }
        .v-store-tag { font-size: 10px; color: var(--vira-gold); font-weight: 900; letter-spacing: 1px; margin-bottom: 5px; display: block; }
        .v-name { font-size: 14px; font-weight: 700; height: 40px; overflow: hidden; margin-bottom: 12px; color: #333; }
        
        .btn-add {
            background: #000; color: var(--vira-gold); border: none; width: 100%; padding: 12px;
            border-radius: 15px; font-weight: 900; cursor: pointer; transition: 0.3s;
        }
        .btn-add:active { transform: scale(0.95); }

        /* Ø§Ù„Ø³Ù„Ø© Ø§Ù„Ù…Ù„ÙƒÙŠØ© */
        .v-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 9500; backdrop-filter: blur(10px); }
        .v-modal-body { background: #fff; width: 90%; max-width: 450px; margin: 50px auto; border-radius: 35px; padding: 30px; position: relative; max-height: 85vh; overflow-y: auto; }
        .cart-merchant-block { background: #f9f9f9; border-radius: 20px; padding: 15px; margin-bottom: 15px; border-right: 5px solid var(--vira-gold); }
        .merchant-name { font-size: 12px; font-weight: 900; color: var(--vira-gold); margin-bottom: 10px; }

        /* Ø¨Ù†ÙƒÙƒ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ¬Ø§Ø± */
        .bank-info { background: #e3f2fd; padding: 20px; border-radius: 20px; border: 1px dashed #2196f3; margin-bottom: 20px; text-align: center; }

        /* Ø§Ù„Ù†Ø§Ù Ø¨Ø§Ø± */
        .v-nav {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 90%;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(20px); border-radius: 100px;
            display: flex; justify-content: space-around; padding: 15px; border: 1px solid #eee; z-index: 9100;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .nav-item { font-size: 22px; cursor: pointer; transition: 0.3s; color: #ccc; }
        .nav-item.active { color: var(--vira-gold); transform: scale(1.2); }
    </style>
</head>
<body>

<div id="splash"><div class="v-logo">VIRA</div></div>

<header class="v-header"><h1>VIRA MALL</h1></header>

<div id="home">
    <div class="section-title">ğŸ‘‘ VIRA EXCLUSIVE</div>
    <div id="viraGrid" class="v-grid"></div>

    <div class="section-title">ğŸŒ Ø§Ù„Ù…ØªØ§Ø¬Ø± Ø§Ù„Ø´Ø±ÙŠÙƒØ©</div>
    <div id="otherGrid" class="v-grid"></div>
</div>

<div id="cartModal" class="v-modal">
    <div class="v-modal-body">
        <h2 style="text-align:center;">Ø­Ù‚ÙŠØ¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ğŸ›ï¸</h2>
        <div id="cartContent"></div>
        <div style="text-align:center; padding:20px; background:#fff; border-top:2px solid #eee;">
            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
            <h1 id="totalSDG" style="margin:0">0 SDG</h1>
            <p style="font-size:11px; color:#888; margin:10px 0;">* Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© ÙƒÙ„ ØªØ§Ø¬Ø± Ù„ÙƒÙ„ Ø·Ù„Ø¨ Ø¹Ù„Ù‰ Ø­Ø¯Ø© Ù„Ø¶Ù…Ø§Ù† Ø£ÙØ¶Ù„ Ø³Ø¹Ø±.</p>
            <button class="btn-add" style="padding:18px;" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
            <button onclick="closeModal('cartModal')" style="background:none; border:none; color:red; margin-top:15px; font-weight:700;">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>
</div>

<div id="merchantModal" class="v-modal">
    <div class="v-modal-body">
        <h2 style="text-align:center; color:var(--vira-gold);">Ø§Ù†Ø¶Ù…ÙŠ Ù„ØªØ§Ø¬Ø±Ø§Øª ÙÙŠØ±Ø§ ğŸ‘‘</h2>
        <div class="bank-info">
            <p style="margin:0; font-size:14px; color:#0d47a1;">Ø±Ø³ÙˆÙ… ÙØªØ­ Ø§Ù„Ù…ØªØ¬Ø± ÙˆØªÙØ¹ÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø¨: <b>30,000 SDG</b></p>
            <h3 style="margin:10px 0; color:#0d47a1;">Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙƒ: <br> <span style="font-size:24px; letter-spacing:2px;">1234567</span></h3>
            <p style="font-size:12px;">Ø¨Ø§Ø³Ù…: Ø¥Ø¯Ø§Ø±Ø© VIRA MALL</p>
        </div>
        <input type="text" id="storeName" placeholder="Ø§Ø³Ù… Ù…ØªØ¬Ø±Ùƒ" style="width:100%; padding:15px; border-radius:15px; border:1px solid #eee; margin-bottom:10px;">
        <input type="text" id="storePhone" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨" style="width:100%; padding:15px; border-radius:15px; border:1px solid #eee; margin-bottom:10px;">
        <p style="font-size:11px; color:#666;">* Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙÙŠ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ØªÙŠ Ø³ØªÙØªØ­ Ù„ÙƒÙ.</p>
        <button class="btn-add" onclick="joinMerchant()">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</button>
        <button onclick="closeModal('merchantModal')" style="background:none; border:none; color:red; margin-top:15px; width:100%;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<nav class="v-nav">
    <div class="nav-item active" onclick="location.reload()">ğŸ </div>
    <div class="nav-item" onclick="openModal('cartModal')">ğŸ›’</div>
    <div class="nav-item" onclick="openModal('merchantModal')">ğŸ‘‘</div>
</nav>

<script>
    const SHEET_ID = '1UZnlp45dVMRJxNibcg3fm52H6S4DB4YbGLr4KK3jPqs';
    let fullData = []; let cart = [];

    setTimeout(() => { document.getElementById('splash').style.opacity = '0'; setTimeout(()=>document.getElementById('splash').remove(), 1000); }, 2000);

    async function init() {
        try {
            const [r1, r2] = await Promise.all([
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`),
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=1152504859`)
            ]);
            const d1 = await r1.text(); const d2 = await r2.text();
            
            const parse = (csv, isV) => {
                const rows = csv.split('\n').map(l => l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/));
                const h = rows[0].map(x => x.replace(/"/g,'').trim());
                return rows.slice(1).map(c => {
                    const f = (k) => { const i = h.findIndex(x => x.includes(k)); return i!==-1?c[i]?.replace(/"/g,'').trim():''; };
                    return {
                        name: isV ? c[0] : f('Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬'),
                        price: isV ? c[1] : f('Ø§Ù„Ø³Ø¹Ø±'),
                        store: isV ? (c[2]||'VIRA') : (f('Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±')||'Ù…ØªØ¬Ø± Ø´Ø±ÙŠÙƒ'),
                        img: isV ? c[3] : f('Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©')
                    };
                }).filter(p => p.name && p.img && p.img.includes('http'));
            };

            fullData = [...parse(d1, true), ...parse(d2, false)];
            render(fullData);
        } catch(e) { console.log("Error Loading Data"); }
    }

    function render(data) {
        let vHTML = '', oHTML = '';
        data.forEach((p, idx) => {
            const card = `
                <div class="v-card">
                    <div class="v-img-box"><img src="${p.img.split(';')[0]}" loading="lazy"></div>
                    <div class="v-price">${p.price}</div>
                    <div class="v-content">
                        <span class="v-store-tag">${p.store}</span>
                        <div class="v-name">${p.name}</div>
                        <button class="btn-add" onclick="addToCart(${idx})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
                    </div>
                </div>`;
            // Ù…Ø­Ø±Ùƒ Ø§Ù„ÙØ±Ø² Ø§Ù„Ø°ÙƒÙŠ Ù„Ù€ Vira
            if(p.store.toLowerCase().includes('vira') || p.store.includes('ÙÙŠØ±Ø§')) vHTML += card;
            else oHTML += card;
        });
        document.getElementById('viraGrid').innerHTML = vHTML;
        document.getElementById('otherGrid').innerHTML = oHTML;
    }

    function addToCart(idx) {
        cart.push(fullData[idx]);
        updateCartUI();
        alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø³Ù„ØªÙƒ âœ¨');
    }

    function updateCartUI() {
        const groups = cart.reduce((acc, obj) => {
            if (!acc[obj.store]) acc[obj.store] = [];
            acc[obj.store].push(obj);
            return acc;
        }, {});

        document.getElementById('cartContent').innerHTML = Object.keys(groups).map(store => `
            <div class="cart-merchant-block">
                <div class="merchant-name">ğŸ¢ Ø§Ù„Ù…ØªØ¬Ø±: ${store}</div>
                ${groups[store].map((item, i) => `<div style="display:flex; justify-content:space-between; font-size:13px; margin-bottom:5px;"><span>${item.name}</span><span>${item.price}</span></div>`).join('')}
                <div style="font-size:9px; color:#888; border-top:1px solid #eee; padding-top:5px; margin-top:5px;">Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØ¬Ø± ÙŠØ­Ø¯Ø¯ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„ØªØ§Ø¬Ø±.</div>
            </div>
        `).join('');

        const total = cart.reduce((a,i) => a + parseInt(i.price.replace(/[^0-9]/g,'')||0), 0);
        document.getElementById('totalSDG').innerText = `${total.toLocaleString()} SDG`;
    }

    function sendOrder() {
        if(!cart.length) return;
        const msg = encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† VIRA MALL ğŸ‘‘\n\n${cart.map(i=>`â€¢ ${i.name} [${i.store}]`).join('\n')}\n\nğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('totalSDG').innerText}\n\n*ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù„ØªØ­Ø¯ÙŠØ¯ Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„ÙƒÙ„ Ù…ØªØ¬Ø±.*`);
        window.open(`https://wa.me/249967584275?text=${msg}`);
    }

    function joinMerchant() {
        const name = document.getElementById('storeName').value;
        if(!name) return alert('ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±');
        const msg = encodeURIComponent(`Ø·Ù„Ø¨ Ø§Ù†Ø¶Ù…Ø§Ù… ØªØ§Ø¬Ø± Ø¬Ø¯ÙŠØ¯ ğŸ‘‘\n\nØ§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±: ${name}\n\n*Ù…Ø±ÙÙ‚ ØµÙˆØ±Ø© Ø¥Ø´Ø¹Ø§Ø± ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù€ 30,000 SDG Ù„Ø­Ø³Ø§Ø¨ÙƒÙ….*`);
        window.open(`https://wa.me/249967584275?text=${msg}`);
    }

    function openModal(id) { document.getElementById(id).style.display = 'block'; }
    function closeModal(id) { document.getElementById(id).style.display = 'none'; }

    init();
</script>
</body>
</html>
