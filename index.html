<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | GLOBAL EXHIBITION</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Cinzel+Decorative:wght@700;900&family=Amiri:wght@700&display=swap" rel="stylesheet">
    
    <style>
        :root { --v-gold: #D4AF37; --v-black: #000000; --v-dark: #0a0a0a; --v-accent: #1a1a1a; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--v-black); color: #fff; font-family: 'Cairo', sans-serif; overflow-x: hidden; padding-bottom: 100px; }

        /* Ù„ÙˆØ¯Ø± ÙØ®Ø§Ù…Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        #v-loader { position: fixed; inset: 0; background: #000; z-index: 999999; display: flex; justify-content: center; align-items: center; transition: 1.5s cubic-bezier(0.7, 0, 0.3, 1); }
        .v-shimmer { font-family: 'Cinzel Decorative'; font-size: 50px; color: var(--v-gold); letter-spacing: 15px; animation: glow 2s infinite; }
        @keyframes glow { 0%, 100% { opacity: 1; filter: drop-shadow(0 0 20px var(--v-gold)); } 50% { opacity: 0.2; } }

        header { position: sticky; top: 0; z-index: 10000; padding: 25px; background: rgba(0,0,0,0.9); backdrop-filter: blur(25px); border-bottom: 1px solid rgba(212,175,55,0.15); display: flex; justify-content: space-between; align-items: center; }
        .brand { font-family: 'Cinzel Decorative'; font-size: 26px; color: var(--v-gold); text-shadow: 0 0 10px rgba(212,175,55,0.3); }

        .search-container { padding: 15px 20px; }
        .v-search { width: 100%; padding: 18px; border-radius: 20px; border: 1px solid #222; background: #0f0f0f; color: #fff; font-family: 'Cairo'; text-align: center; font-size: 15px; transition: 0.3s; }
        .v-search:focus { border-color: var(--v-gold); background: #151515; }

        /* Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .v-section-tag { padding: 40px 20px 15px; font-weight: 900; font-size: 24px; color: var(--v-gold); display: flex; align-items: center; gap: 15px; }
        .v-section-tag::after { content: ''; flex: 1; height: 1px; background: linear-gradient(to left, var(--v-gold), transparent); }
        .v-section-tag span { font-size: 14px; color: #666; font-family: 'Cinzel Decorative'; margin-top: 5px; }

        /* ØªØµÙ…ÙŠÙ… Ù‚Ø³Ù… Ø§Ù„Ø¹Ø·Ø§Ø±Ø© (Ø§Ù„ØªØ±Ø§Ø«ÙŠ) */
        #heritageGrid { background: linear-gradient(to bottom, #0a0a0a, #000); border-radius: 30px; margin: 10px; padding: 10px; border: 1px solid rgba(212,175,55,0.05); }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .main-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; padding: 15px; }
        @media (max-width: 480px) { .main-grid { grid-template-columns: 1fr; } }

        /* ÙƒØ±Øª Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ */
        .v-card { background: var(--v-dark); border-radius: 30px; overflow: hidden; border: 1px solid #1a1a1a; transition: 0.5s; position: relative; }
        .v-card:hover { border-color: var(--v-gold); transform: translateY(-10px); }

        .visual-area { width: 100%; height: 400px; position: relative; overflow: hidden; }
        .img-track { display: flex; width: 100%; height: 100%; overflow-x: auto; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .img-track::-webkit-scrollbar { display: none; }
        .img-track img { min-width: 100%; height: 100%; object-fit: cover; scroll-snap-align: start; cursor: zoom-in; }

        .v-price { position: absolute; top: 20px; left: 0; background: var(--v-gold); color: #000; padding: 8px 18px; border-radius: 0 15px 15px 0; font-weight: 900; font-size: 14px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); z-index: 10; }
        
        .nav-dots { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; }
        .dot { width: 6px; height: 6px; background: rgba(255,255,255,0.3); border-radius: 50%; transition: 0.3s; }
        .dot.active { background: var(--v-gold); width: 20px; border-radius: 10px; }

        .info-area { padding: 25px; text-align: center; }
        .store-tag { font-size: 9px; color: var(--v-gold); font-weight: 900; letter-spacing: 3px; display: block; margin-bottom: 10px; text-transform: uppercase; }
        .item-name { font-size: 18px; font-weight: 700; color: #f0f0f0; height: 50px; overflow: hidden; margin-bottom: 20px; }
        
        .v-add-btn { background: #fff; color: #000; border: none; width: 100%; padding: 18px; border-radius: 20px; font-weight: 900; font-size: 14px; cursor: pointer; transition: 0.3s; }
        .v-add-btn:active { background: var(--v-gold); transform: scale(0.9); }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª */
        #cart-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 200000; padding: 30px; }
        .cart-inner { max-width: 500px; margin: 0 auto; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #222; }

        /* Ø§Ù„Ù†Ø§Ù Ø¨Ø§Ø± Ø§Ù„Ø³ÙÙ„ÙŠ */
        nav { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); width: 85%; max-width: 400px; background: rgba(255,255,255,0.05); backdrop-filter: blur(30px); border-radius: 100px; display: flex; justify-content: space-around; padding: 12px; border: 1px solid rgba(255,255,255,0.1); z-index: 50000; }
        .n-btn { font-size: 24px; color: #555; cursor: pointer; position: relative; }
        .n-btn.active { color: var(--v-gold); }
        .n-badge { position: absolute; top: -5px; right: -10px; background: var(--v-gold); color: #000; font-size: 10px; width: 18px; height: 18px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: 900; }
    </style>
</head>
<body>

<div id="v-loader"><div class="v-shimmer">VIRA</div></div>

<header>
    <div style="font-size:18px; color:var(--v-gold);">GLOBAL EXHIBITION</div>
    <div class="brand">VIRA</div>
    <div onclick="openBag()">ğŸ›’</div>
</header>

<div class="search-container">
    <input type="text" class="v-search" id="vSearch" placeholder="Ù…Ø§Ø°Ø§ ØªØ¨Ø­Ø«ÙŠÙ† Ø¹Ù† Ø§Ù„Ø¬Ù…Ø§Ù„ Ø§Ù„ÙŠÙˆÙ…ØŸ" oninput="searchEngine()">
</div>

<div class="v-section-tag">ğŸ’ VIRA <span>EXCLUSIVE</span></div>
<div id="viraGrid" class="main-grid"></div>

<div class="v-section-tag" style="color: #8c6a2c;">ğŸº HERITAGE <span>Ø§Ù„Ø¹Ø·Ø§Ø±Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ù†ÙŠØ©</span></div>
<div id="heritageGrid" class="main-grid"></div>

<div class="v-section-tag">ğŸ›ï¸ PARTNER <span>STORES</span></div>
<div id="partnerGrid" class="main-grid"></div>

<div id="zoom-box" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.98); z-index:1000000; justify-content:center; align-items:center;" onclick="this.style.display='none'">
    <img id="zoomImg" style="max-width:90%; max-height:80%; border:1px solid var(--v-gold);">
</div>

<div id="cart-modal">
    <div class="cart-inner">
        <h1 style="color:var(--v-gold); text-align:center; font-family:'Cinzel Decorative';">YOUR SELECTIONS</h1>
        <div id="cartBody"></div>
        <div style="text-align:center; margin-top:50px;">
            <p style="color:#444; letter-spacing:5px;">TOTAL AMOUNT</p>
            <h1 id="totalPrice" style="font-size:50px; color:#fff; margin:10px 0;">0</h1>
            <button class="v-add-btn" style="background:var(--v-gold); padding:20px;" onclick="checkout()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙØ®Ù… âš¡</button>
            <p onclick="openBag()" style="margin-top:25px; color:#666;">Ø±Ø¬ÙˆØ¹ Ù„Ù„ØªØ³ÙˆÙ‚</p>
        </div>
    </div>
</div>

<nav>
    <div class="n-btn" onclick="location.reload()">ğŸ </div>
    <div class="n-btn" onclick="openBag()">ğŸ’¼<span class="n-badge" id="bCount">0</span></div>
    <div class="n-btn" onclick="alert('VIRA GLOBAL SYSTEM 2026')">âš™ï¸</div>
</nav>

<script>
    const SHEET_ID = '1UZnlp45dVMRJxNibcg3fm52H6S4DB4YbGLr4KK3jPqs';
    let fullDB = [];
    let bag = [];

    async function viraInit() {
        try {
            const [vR, pR] = await Promise.all([
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`),
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=1152504859`)
            ]);
            
            const parser = (csv, isV) => csv.split('\n').slice(1).map(r => {
                const c = r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(x => x?.replace(/"/g,'').trim());
                // Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø¯Ø©
                const name = isV ? c[0] : c[3];
                const store = isV ? 'VIRA' : (c[1] || 'Vira Partner');
                const price = isV ? c[1] : c[4];
                const img = isV ? c[3] : c[5];
                const desc = isV ? c[4] : c[6]; // Ø§Ù„ÙˆØµÙ ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ G (6)
                return { store, name, price, img, desc };
            }).filter(i => i.name && i.img);

            fullDB = [...parser(await vR.text(), true), ...parser(await pR.text(), false).reverse()];
            render(fullDB);
            
            setTimeout(() => { document.getElementById('v-loader').style.transform = 'translateY(-100%)'; }, 1500);
        } catch (e) { console.error("Global System Offline"); }
    }

    function render(data) {
        let vH = '', pH = '', hH = '';
        data.forEach((p, idx) => {
            const imgs = p.img.split(/[,\s\n\t]+/).filter(l => l.startsWith('http'));
            const dotUI = imgs.length > 1 ? `<div class="nav-dots" id="dots-${idx}">${imgs.map((_,i
