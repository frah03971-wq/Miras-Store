<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIRAS LUXURY MALL</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Playfair+Display:wght@700&display=swap');
        
        :root { --gold: #e5b9a8; --dark: #050505; --accent: #b38b7d; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--dark); margin: 0; color: #fff; overflow-x: hidden; }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø¨Ø­Ø« */
        .top-nav { position: fixed; top: 20px; left: 20px; display: flex; gap: 15px; z-index: 2000; }
        .nav-btn { background: var(--gold); color: #000; padding: 12px; border-radius: 50%; cursor: pointer; box-shadow: 0 4px 15px rgba(229,185,168,0.4); border: none; font-size: 1.2em; display: flex; align-items: center; justify-content: center; }
        #cart-count { font-size: 0.7em; font-weight: bold; background: #fff; padding: 2px 6px; border-radius: 10px; margin-right: 4px; }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        #welcome-screen { min-height: 100vh; background: radial-gradient(circle, #1a1a1a 0%, #000 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; text-align: center; }
        .mall-title { color: var(--gold); font-size: 3.5em; font-family: 'Playfair Display', serif; margin: 0; }
        
        .search-bar { width: 90%; max-width: 500px; margin: 25px 0; position: relative; }
        .search-bar input { width: 100%; padding: 15px 45px; border-radius: 30px; border: 1px solid var(--gold); background: rgba(255,255,255,0.05); color: #fff; font-family: 'Cairo'; outline: none; }
        .search-icon { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: var(--gold); }

        .store-selector { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; max-width: 900px; width: 100%; }
        .store-card { height: 160px; position: relative; border: 1px solid #222; cursor: pointer; overflow: hidden; border-radius: 5px; }
        .store-card img { width: 100%; height: 100%; object-fit: cover; opacity: 0.4; transition: 0.5s; }
        .store-card:hover img { opacity: 0.7; transform: scale(1.1); }
        .store-card h2 { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: var(--gold); width: 100%; text-align: center; background: rgba(0,0,0,0.5); padding: 5px 0; margin: 0; }

        /* Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ ÙˆØ§Ù„Ø³Ù„Ø© */
        #main-store, #cart-view { display: none; min-height: 100vh; padding-top: 80px; }
        header { padding: 30px; text-align: center; color: var(--gold); }
        .back-btn { background: transparent; color: var(--gold); border: 1px solid var(--gold); padding: 8px 20px; margin: 20px; cursor: pointer; border-radius: 20px; }

        .products-grid { display: flex; flex-direction: column; gap: 40px; padding: 20px; max-width: 700px; margin: 0 auto; }
        .product-card { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 15px; overflow: hidden; }
        .image-gallery img { width: 100%; height: auto; border-bottom: 1px solid #1a1a1a; }
        
        .card-content { padding: 25px; text-align: right; }
        .price { color: var(--gold); font-weight: bold; font-size: 2em; display: block; margin: 10px 0; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        .btn-add-cart { flex: 1; background: var(--gold); color: #000; padding: 15px; border: none; font-weight: bold; cursor: pointer; border-radius: 8px; }
        .btn-whatsapp { flex: 1; background: transparent; border: 1px solid #25d366; color: #25d366; padding: 15px; font-weight: bold; text-align: center; text-decoration: none; border-radius: 8px; }

        /* Ø§Ù„Ø³Ù„Ø© */
        .cart-content { max-width: 600px; margin: 0 auto; padding: 20px; background: #0a0a0a; border: 1px solid var(--gold); border-radius: 15px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #222; }
        .remove-item { color: #ff4444; cursor: pointer; font-size: 0.8em; }
        .total-box { margin-top: 20px; font-size: 1.5em; text-align: center; color: var(--gold); border-top: 2px solid var(--gold); padding-top: 15px; }
        .btn-checkout { width: 100%; background: #25d366; color: #fff; padding: 20px; border: none; font-weight: bold; font-size: 1.2em; margin-top: 20px; border-radius: 10px; cursor: pointer; }

        @media (max-width: 600px) { .store-selector { grid-template-columns: 1fr; } .mall-title { font-size: 2.5em; } }
    </style>
</head>
<body>

<div class="top-nav">
    <button class="nav-btn" onclick="showCart()">
        ğŸ›’ <span id="cart-count">0</span>
    </button>
</div>

<div id="welcome-screen">
    <h1 class="mall-title">MIRAS MALL</h1>
    <p style="color: #888; letter-spacing: 5px; font-size: 0.7em;">EXPERIENCE LUXURY</p>
    
    <div class="search-bar">
        <span class="search-icon">ğŸ”</span>
        <input type="text" id="main-search" placeholder="Ø§Ø¨Ø­Ø«ÙŠ Ø¹Ù† ÙØ³ØªØ§Ù†ØŒ Ø´Ù†Ø·Ø©ØŒ Ø£Ùˆ Ù…Ø§Ø±ÙƒØ©..." onkeyup="handleSearch(event)">
    </div>

    <div class="store-selector">
        <div class="store-card" onclick="openStore('VIRA Boutique')"><h2>Ø§Ù„Ø´Ù†Ø· (VIRA)</h2><img src="https://i.ibb.co/RpzYpBQ1/Screenshot-com-zzkko-Goods-Detail-Activity-edit-357786989274816.jpg"></div>
        <div class="store-card" onclick="openStore('Ù…ÙŠØ±Ø§Ø³ Ù„Ù„ÙØ³Ø§ØªÙŠÙ†')"><h2>Ø§Ù„ÙØ³Ø§ØªÙŠÙ†</h2><img src="https://via.placeholder.com/400x600/111/e5b9a8?text=DRESSES"></div>
        <div class="store-card" onclick="openStore('Ù…ÙŠØ±Ø§Ø³ Ù„Ù„Ø¬Ø²Ù…')"><h2>Ø§Ù„Ø¬Ø²Ù…</h2><img src="https://via.placeholder.com/400x600/111/e5b9a8?text=SHOES"></div>
        <div class="store-card" onclick="openStore('Ù…ÙŠØ±Ø§Ø³ Ù„Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª')"><h2>Ø§Ù„Ø§ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª</h2><img src="https://via.placeholder.com/400x600/111/e5b9a8?text=ACCESSORIES"></div>
        <div class="store-card" onclick="openStore('Ù…ÙŠØ±Ø§Ø³ Ù„Ù„Ø¹Ù†Ø§ÙŠØ©')"><h2>Ø§Ù„Ø¹Ù†Ø§ÙŠØ©</h2><img src="https://via.placeholder.com/400x600/111/e5b9a8?text=CARE"></div>
        <div class="store-card" onclick="openStore('Ù…ÙŠØ±Ø§Ø³ Ù„Ù„Ø¶ÙŠØ§ÙØ©')"><h2>Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§</h2><img src="https://via.placeholder.com/400x600/111/e5b9a8?text=GIFTS"></div>
    </div>
</div>

<div id="main-store">
    <button class="back-btn" onclick="goHome()">â¬… Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ„</button>
    <header><h1 id="store-name" style="font-family: 'Playfair Display';"></h1></header>
    <div class="products-grid" id="products-container"></div>
</div>

<div id="cart-view">
    <button class="back-btn" onclick="closeCart()">â¬… Ù…ÙˆØ§ØµÙ„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</button>
    <div class="cart-content">
        <h2 style="text-align: center; color: var(--gold);">Ø­Ù‚ÙŠØ¨Ø© ØªØ³ÙˆÙ‚Ùƒ ğŸ›ï¸</h2>
        <div id="cart-items-list"></div>
        <div class="total-box">
            Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="cart-total">0</span> SDG
        </div>
        <button class="btn-checkout" onclick="checkout()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ âœ…</button>
    </div>
</div>

<script>
    const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?output=csv';
    let allProducts = [], cart = [];

    async function loadData() {
        try {
            const response = await fetch(sheetUrl + '&t=' + Date.now());
            const text = await response.text();
            const rows = text.split('\n').filter(r => r.trim() !== '');
            allProducts = rows.slice(1).map(row => {
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                return {
                    name: cols[0]?.replace(/"/g, '').trim(),
                    price: parseFloat(cols[1]?.replace(/"/g, '').trim()) || 0,
                    shop: cols[2]?.replace(/"/g, '').trim(),
                    img: cols[3]?.replace(/"/g, '').trim(),
                    phone: cols[4]?.replace(/"/g, '').replace(/[^\d]/g, '').trim() || '249967584275',
                    desc: cols[5]?.replace(/"/g, '').trim() || ''
                };
            });
        } catch (e) { console.error("Data error"); }
    }

    function handleSearch(e) {
        if (e.key === 'Enter' || e.type === 'keyup') {
            const term = document.getElementById('main-search').value.toLowerCase();
            if (term.length < 2 && e.type !== 'Enter') return;
            
            const results = allProducts.filter(p => 
                p.name.toLowerCase().includes(term) || 
                p.desc.toLowerCase().includes(term) || 
                p.shop.toLowerCase().includes(term)
            );
            
            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('main-store').style.display = 'block';
            document.getElementById('store-name').innerText = `Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù†: ${term}`;
            displayProducts(results);
        }
    }

    function openStore(shopName) {
        document.getElementById('welcome-screen').style.display = 'none';
        document.getElementById('main-store').style.display = 'block';
        document.getElementById('store-name').innerText = shopName;
        displayProducts(allProducts.filter(p => p.shop === shopName));
        window.scrollTo(0,0);
    }

    function displayProducts(products) {
        const container = document.getElementById('products-container');
        container.innerHTML = products.length ? '' : '<h2 style="text-align:center;">Ù„Ù… Ù†Ø¬Ø¯ Ù†ØªØ§Ø¦Ø¬ØŒ Ø¬Ø±Ø¨ÙŠ ÙƒÙ„Ù…Ø© Ø£Ø®Ø±Ù‰ âœ¨</h2>';
        
        products.forEach(p => {
            const images = p.img.split(',');
            let gallery = '<div class="image-gallery">';
            images.forEach(img => gallery += `<img src="${img.trim()}">`);
            gallery += '</div>';

            container.innerHTML += `
                <div class="product-card">
                    ${gallery}
                    <div class="card-content">
                        <h3>${p.name}</h3>
                        <span class="price">${p.price} SDG</span>
                        <p style="color:#888;">${p.desc}</p>
                        <div class="btn-group">
                            <button class="btn-add-cart" onclick="addToCart('${p.name}', ${p.price}, '${p.phone}')">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
                            <a href="https://api.whatsapp.com/send?phone=${p.phone}&text=${encodeURIComponent('Ø£Ø±ÙŠØ¯ Ø·Ù„Ø¨: ' + p.name)}" target="_blank" class="btn-whatsapp">Ø·Ù„Ø¨ Ø³Ø±ÙŠØ¹ âš¡</a>
                        </div>
                    </div>
                </div>`;
        });
    }

    function addToCart(name, price, phone) {
        cart.push({name, price, phone});
        document.getElementById('cart-count').innerText = cart.length;
        alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ' + name + ' Ø¨Ù†Ø¬Ø§Ø­! âœ…');
    }

    function showCart() {
        document.getElementById('welcome-screen').style.display = 'none';
        document.getElementById('main-store').style.display = 'none';
        document.getElementById('cart-view').style.display = 'block';
        
        const list = document.getElementById('cart-items-list');
        list.innerHTML = '';
        let total = 0;
        cart.forEach((item, i) => {
            list.innerHTML += `
                <div class="cart-item">
                    <div>
                        <strong>${item.name}</strong><br>
                        <span style="color:var(--gold)">${item.price} SDG</span>
                    </div>
                    <span class="remove-item" onclick="removeItem(${i})">Ø­Ø°Ù âŒ</span>
                </div>`;
            total += item.price;
        });
        document.getElementById('cart-total').innerText = total;
    }

    function removeItem(i) {
        cart.splice(i, 1);
        document.getElementById('cart-count').innerText = cart.length;
        showCart();
    }

    function checkout() {
        if (cart.length === 0) return alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!');
        let msg = "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ù…ÙŠØ±Ø§Ø³ØŒ Ø£ÙˆØ¯ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ØªØ§Ù„ÙŠ:\n\n";
        let total = 0;
        cart.forEach(item => {
            msg += `ğŸ“ ${item.name} - ${item.price} SDG\n`;
            total += item.price;
        });
        msg += `\nğŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ: ${total} SDG\nâœ¨ Ø´ÙƒØ±Ø§Ù‹ Ù„ÙƒÙ!`;
        window.open(`https://api.whatsapp.com/send?phone=${cart[0].phone}&text=${encodeURIComponent(msg)}`);
    }

    function goHome() { location.reload(); }
    function closeCart() { document.getElementById('cart-view').style.display = 'none'; document.getElementById('main-store').style.display = 'block'; }

    window.onload = loadData;
</script>
</body>
</html>
