<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | ÙÙŠØ±Ø§ Ù…ÙˆÙ„</title>
    <style>
        :root { --gold: #D4AF37; --black: #0a0a0a; --gray: #f4f4f4; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #fff; color: var(--black); transition: 0.3s; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header { background: var(--black); padding: 12px 15px; position: sticky; top: 0; z-index: 2000; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .nav-top { display: flex; justify-content: space-between; align-items: center; }
        .logo { text-align: center; flex-grow: 1; }
        header h1 { color: var(--gold); margin: 0; font-size: 20px; font-weight: 900; letter-spacing: 1px; }
        .logo span { color: #fff; font-size: 9px; display: block; font-weight: bold; }
        
        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-area { background: #fff; margin-top: 10px; padding: 6px 15px; border-radius: 25px; display: flex; align-items: center; gap: 8px; }
        .search-area input { border: none; width: 100%; outline: none; font-size: 14px; }

        /* Ø§Ù„Ø´Ø¨ÙƒØ© (Grid) */
        .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 12px; }
        .card { background: #fff; position: relative; border-radius: 8px; overflow: hidden; border: 1px solid #eee; }
        
        /* Ø³Ù„Ø§ÙŠØ¯Ø± Ø§Ù„ØµÙˆØ± */
        .slider-container { position: relative; width: 100%; aspect-ratio: 3/4; overflow: hidden; background: #eee; }
        .track { display: flex; height: 100%; transition: transform 0.3s ease-out; }
        .track img { min-width: 100%; height: 100%; object-fit: cover; }
        
        /* Ø¹Ø¯Ø§Ø¯ Ø´ÙŠ Ø¥Ù† (1/3) */
        .img-counter { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.5); color: #fff; padding: 2px 7px; border-radius: 10px; font-size: 10px; }
        
        .fav-btn { position: absolute; top: 8px; left: 8px; color: #fff; font-size: 20px; z-index: 5; text-shadow: 0 0 5px rgba(0,0,0,0.5); cursor: pointer; }
        .fav-btn.active { color: #e91e63; }

        .info { padding: 10px 5px; text-align: center; }
        .title { font-size: 11px; color: #555; height: 30px; overflow: hidden; margin-bottom: 5px; }
        .price { font-size: 15px; font-weight: 900; color: var(--black); }
        .add-cart { width: 100%; background: var(--black); color: #fff; border: none; padding: 8px; font-size: 11px; font-weight: bold; cursor: pointer; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .menu-panel { position: fixed; top: 0; right: -100%; width: 300px; height: 100%; background: #fff; z-index: 3000; transition: 0.4s; padding: 25px; box-shadow: -5px 0 20px rgba(0,0,0,0.2); }
        .menu-panel.active { right: 0; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2500; display: none; }
        
        .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid var(--gold); padding-bottom: 10px; }
        .menu-item { padding: 15px 0; border-bottom: 1px solid #eee; font-weight: bold; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        
        /* Ø£Ø²Ø±Ø§Ø± ØªØºÙŠÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ù†ÙŠÙˆ */
        .currency-switcher { display: flex; gap: 5px; margin-top: 5px; }
        .cur-btn { padding: 4px 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 12px; background: #f9f9f9; }
        .cur-btn.active { background: var(--gold); color: #fff; border-color: var(--gold); }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<header>
    <div class="nav-top">
        <div onclick="toggleMenu()" style="color:var(--gold); font-size:26px; cursor:pointer;">â˜°</div>
        <div class="logo">
            <h1>VIRA MALL</h1>
            <span>Ø®ÙŠÙ€Ø§Ø±Ùƒ Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³Ù€ÙˆØ¯Ø§Ù†</span>
        </div>
        <div style="color:var(--gold); font-size:22px; cursor:pointer;" onclick="toggleMenu()">ğŸ›’</div>
    </div>
    <div class="search-area">
        <span>ğŸ”</span>
        <input type="text" placeholder="Ø§Ø¨Ø­Ø«ÙŠ Ø¹Ù† Ø¹Ø¨Ø§ÙŠØ§ØªØŒ Ø´Ù†Ø·ØŒ Ø¬Ø²Ù…..." oninput="search(this.value)">
    </div>
</header>

<div class="grid" id="mainGrid">
    <p style="grid-column: span 2; text-align:center; padding:50px;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ù†Ø§Ù‚Ø©... âœ¨</p>
</div>

<div class="menu-panel" id="sideMenu">
    <div class="menu-header">
        <h2 style="margin:0; font-size:18px;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±</h2>
        <span onclick="toggleMenu()" style="font-size:24px; cursor:pointer;">âœ•</span>
    </div>

    <div class="menu-item" onclick="changeLang()">
        <span>ğŸŒ Ù„ØºØ© Ø§Ù„Ù…ØªØ¬Ø± (Language)</span>
        <span id="langDisplay" style="color:var(--gold);">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
    </div>

    <div class="menu-item" style="flex-direction: column; align-items: flex-start; gap: 10px;">
        <span>ğŸ’° ØªØºÙŠÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø© (Currency)</span>
        <div class="currency-switcher">
            <button class="cur-btn active" onclick="updateCurrency('SDG', this)">SDG</button>
            <button class="cur-btn" onclick="updateCurrency('SAR', this)">SAR</button>
            <button class="cur-btn" onclick="updateCurrency('USD', this)">USD</button>
        </div>
    </div>

    <div class="menu-item">ğŸ›ï¸ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</div>
    <div class="menu-item">â¤ï¸ Ø§Ù„Ù…ÙØ¶Ù„Ø©</div>
    <div class="menu-item" style="color:var(--gold);">ğŸš€ Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªØ§Ø¬Ø±Ø§Øª (Ø§Ø´ØªØ±Ø§Ùƒ 30,000)</div>
    <div class="menu-item">ğŸšš Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ØªÙˆØµÙŠÙ„</div>
</div>

<script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?gid=0&single=true&output=csv';
    let products = [];
    let currentCurrency = 'SDG';

    async function loadData() {
        const res = await fetch(CSV_URL + '&t=' + Date.now());
        const text = await res.text();
        const rows = text.split('\n').slice(1);
        products = rows.map((r, i) => {
            const c = r.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(v => v.replace(/"/g, '').trim());
            if(!c[0]) return null;
            return { id: i, name: c[0], price: c[1], store: c[2], imgs: c[3].split(/\s+/), wa: c[4] };
        }).filter(p => p);
        render(products);
    }

    function render(data) {
        const grid = document.getElementById('mainGrid');
        grid.innerHTML = data.map(p => {
            const hasMultiple = p.imgs.length > 1;
            return `
            <div class="card" id="p-${p.id}" data-idx="0">
                <div class="slider-container" ontouchstart="sT(event)" ontouchmove="mT(event, ${p.id})">
                    <div class="fav-btn" onclick="this.classList.toggle('active')">â¤</div>
                    <div class="track">${p.imgs.map(img => `<img src="${img}">`).join('')}</div>
                    ${hasMultiple ? `<div class="img-counter"><span class="cur">1</span>/${p.imgs.length}</div>` : ''}
                </div>
                <div class="info">
                    <div class="title">${p.name}</div>
                    <div class="price">${p.price} ${currentCurrency}</div>
                    <button class="add-cart" onclick="window.open('https://wa.me/${p.wa}')">Ø·Ù„Ø¨ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨</button>
                </div>
            </div>
        `}).join('');
    }

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…Ù„Ø©
    function updateCurrency(cur, btn) {
        currentCurrency = cur;
        document.querySelectorAll('.cur-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        render(products); // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø¨Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø­Ø¨ (Slide)
    let tX = 0;
    function sT(e) { tX = e.touches[0].clientX; }
    function mT(e, id) {
        if(!tX) return;
        let diff = tX - e.touches[0].clientX;
        if(Math.abs(diff) > 30) {
            const card = document.getElementById(`p-${id}`);
            const track = card.querySelector('.track');
            const curCounter = card.querySelector('.cur');
            let idx = parseInt(card.dataset.idx) + (diff > 0 ? 1 : -1);
            if(idx >= 0 && idx < track.children.length) {
                card.dataset.idx = idx;
                track.style.transform = `translateX(${idx * 100}%)`;
                if(curCounter) curCounter.innerText = idx + 1;
            }
            tX = 0;
        }
    }

    function toggleMenu() {
        document.getElementById('sideMenu').classList.toggle('active');
        document.getElementById('overlay').style.display = 
            document.getElementById('sideMenu').classList.contains('active') ? 'block' : 'none';
    }

    function search(q) {
        const filtered = products.filter(p => p.name.includes(q));
        render(filtered);
    }

    loadData();
</script>
</body>
</html>
