<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | WORLD CLASS</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Cinzel+Decorative:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --amazon-orange: #ff9900; 
            --vira-gold: #D4AF37;
            --dark-bg: #131921; /* Ù„ÙˆÙ† Ø®Ù„ÙÙŠØ© Ø£Ù…Ø§Ø²ÙˆÙ† Ø§Ù„Ø´Ù‡ÙŠØ± */
            --card-bg: #ffffff;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: #f3f3f3; color: #111; font-family: 'Cairo', sans-serif; overflow-x: hidden; padding-bottom: 100px; }

        /* Loader */
        #loader { position: fixed; inset: 0; background: var(--dark-bg); z-index: 999999; display: flex; justify-content: center; align-items: center; transition: 0.8s; }
        .v-logo-anim { font-family: 'Cinzel Decorative'; font-size: 60px; color: var(--vira-gold); animation: pulse 1.5s infinite; letter-spacing: 10px; }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(0.9); opacity: 0.5; } }

        /* Header */
        header { position: sticky; top: 0; z-index: 10000; padding: 15px 20px; background: var(--dark-bg); display: flex; flex-direction: column; gap: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .header-top { display: flex; justify-content: space-between; align-items: center; }
        .brand-name { font-family: 'Cinzel Decorative'; font-size: 30px; color: #fff; font-weight: 900; }
        .brand-name span { color: var(--amazon-orange); }

        /* Search Bar */
        .search-box { background: #fff; border-radius: 8px; display: flex; padding: 2px; overflow: hidden; }
        .search-box input { flex: 1; border: none; padding: 12px; font-family: 'Cairo'; outline: none; font-size: 16px; }
        .search-box button { background: var(--amazon-orange); border: none; padding: 0 20px; cursor: pointer; border-radius: 0 6px 6px 0; }

        /* Grid */
        .main-container { padding: 15px; display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        @media (max-width: 600px) { .main-container { grid-template-columns: 1fr; } }

        /* Product Card */
        .p-card { background: var(--card-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: relative; border: 1px solid #ddd; }
        .swiper { width: 100%; height: 400px; }
        .swiper-slide { display: flex; justify-content: center; align-items: center; background: #fff; }
        .swiper-slide img { width: 100%; height: 100%; object-fit: contain; }
        
        .price-tag { position: absolute; top: 15px; left: 0; background: #cc0c39; color: #fff; padding: 5px 15px; border-radius: 0 20px 20px 0; font-weight: 900; z-index: 100; font-size: 18px; }
        
        .p-details { padding: 15px; border-top: 1px solid #eee; }
        .store-label { color: #007185; font-size: 12px; font-weight: bold; margin-bottom: 5px; display: block; }
        .product-title { font-size: 16px; font-weight: 700; color: #111; height: 45px; overflow: hidden; margin-bottom: 10px; line-height: 1.4; }
        
        .add-to-cart-btn { background: #ffd814; border: 1px solid #fcd200; color: #0f1111; width: 100%; padding: 12px; border-radius: 20px; font-weight: 700; cursor: pointer; font-size: 14px; box-shadow: 0 2px 5px rgba(213,217,217,.5); }
        .add-to-cart-btn:active { background: #f7ca00; }

        /* Floating Cart & Navigation */
        nav { position: fixed; bottom: 0; width: 100%; background: #fff; display: flex; justify-content: space-around; padding: 15px; border-top: 1px solid #ddd; z-index: 500000; }
        .nav-item { text-align: center; font-size: 12px; color: #111; position: relative; }
        .cart-count { position: absolute; top: -10px; right: -5px; background: var(--amazon-orange); color: #fff; border-radius: 50%; width: 20px; height: 20px; font-size: 11px; display: flex; justify-content: center; align-items: center; font-weight: 900; }

        /* Full Screen Pages */
        .page-overlay { display: none; position: fixed; inset: 0; background: #fff; z-index: 1000000; padding: 20px; overflow-y: auto; }
        .close-page { font-size: 30px; cursor: pointer; padding: 10px; display: block; }
    </style>
</head>
<body>

<div id="loader"><div class="v-logo-anim">VIRA</div></div>

<header>
    <div class="header-top">
        <div class="brand-name">V<span>IRA</span></div>
        <div style="color:#fff; font-size:12px; text-align:left;">Ø­Ø³Ø§Ø¨ Ø¨Ù†ÙƒÙƒ: <b>2280384</b></div>
    </div>
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Ø§Ø¨Ø­Ø«ÙŠ ÙÙŠ Ù…ØªØ§Ø¬Ø± ÙÙŠØ±Ø§..." oninput="filterProducts()">
        <button>ğŸ”</button>
    </div>
</header>

<div id="productGrid" class="main-container"></div>

<div id="cartPage" class="page-overlay">
    <span class="close-page" onclick="togglePage('cartPage')">Ã—</span>
    <h2 style="text-align:center;">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
    <div id="cartContent"></div>
    <div style="padding: 20px; border-top: 2px solid #eee; margin-top: 20px;">
        <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="totalPrice">0</span> SDG</h3>
        <p style="color: #666; font-size: 13px;">* Ø§Ù„ØªÙˆØµÙŠÙ„ ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡ Ø­Ø³Ø¨ ÙƒÙ„ Ù…ØªØ¬Ø±</p>
        <button class="add-to-cart-btn" style="background:var(--amazon-orange); padding:20px; font-size:18px;" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨ âœ…</button>
    </div>
</div>

<nav>
    <div class="nav-item" onclick="location.reload()">ğŸ <br>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
    <div class="nav-item" onclick="togglePage('cartPage')">ğŸ›’<br>Ø§Ù„Ø³Ù„Ø© <span class="cart-count" id="cartBadge">0</span></div>
    <div class="nav-item" onclick="window.open('https://wa.me/249967584275')">ğŸ’¬<br>Ù…Ø³Ø§Ø¹Ø¯Ø©</div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTWD0ZQAKe2KRwLQnNjh2t7Z2Y_BKXxaKZxZwKSXUaZLQ3eeLB1fwj6vNllpNwXCtd9aY9Q_tuuFXXV/pub?output=csv';
    let allProducts = [];
    let cart = [];

    async function loadViraMall() {
        try {
            const response = await fetch(CSV_URL);
            const data = await response.text();
            const rows = data.split('\n').slice(1);
            
            allProducts = rows.map((row, index) => {
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/"/g,'').trim());
                return {
                    id: index,
                    store: cols[1] || 'Vira Store',
                    name: cols[3] || '',
                    price: cols[4] || '0',
                    images: cols[5] ? cols[5].split(/[,\s\n\t]+/).filter(l => l.includes('http')) : []
                };
            }).filter(p => p.name !== "");

            renderProducts(allProducts);
            document.getElementById('loader').style.opacity = '0';
            setTimeout(() => document.getElementById('loader').style.display = 'none', 800);
        } catch (e) {
            console.error(e);
            alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        }
    }

    function renderProducts(products) {
        const grid = document.getElementById('productGrid');
        grid.innerHTML = products.map((p, i) => `
            <div class="p-card">
                <div class="price-tag">${p.price}</div>
                <div class="swiper swiper-${i}">
                    <div class="swiper-wrapper">
                        ${p.images.map(img => `
                            <div class="swiper-slide">
                                <div class="swiper-zoom-container">
                                    <img src="${img}" onerror="this.src='https://placehold.co/400x500?text=VIRA'">
                                </div>
                            </div>`).join('')}
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
                <div class="p-details">
                    <span class="store-label">${p.store}</span>
                    <div class="product-title">${p.name}</div>
                    <button class="add-to-cart-btn" onclick="addToCart(${p.id})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø© ğŸ›’</button>
                </div>
            </div>
        `).join('');

        products.forEach((p, i) => {
            new Swiper(`.swiper-${i}`, {
                pagination: { el: '.swiper-pagination' },
                zoom: { maxRatio: 3 },
                grabCursor: true
            });
        });
    }

    function addToCart(id) {
        const item = allProducts.find(p => p.id === id);
        cart.push(item);
        document.getElementById('cartBadge').innerText = cart.length;
        alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ' + item.name + ' Ø¨Ù†Ø¬Ø§Ø­! ğŸ›ï¸');
    }

    function togglePage(id) {
        const page = document.getElementById(id);
        page.style.display = (page.style.display === 'block') ? 'none' : 'block';
        if(id === 'cartPage') updateCartDisplay();
    }

    function updateCartDisplay() {
        const container = document.getElementById('cartContent');
        if(cart.length === 0) {
            container.innerHTML = '<p style="text-align:center; padding:50px;">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
            return;
        }
        container.innerHTML = cart.map((item, index) => `
            <div style="display:flex; gap:15px; padding:15px; border-bottom:1px solid #eee; align-items:center;">
                <img src="${item.images[0]}" style="width:60px; height:60px; border-radius:8px; object-fit:cover;">
                <div style="flex:1">
                    <div style="font-weight:bold;">${item.name}</div>
                    <div style="color:var(--amazon-orange); font-weight:900;">${item.price}</div>
                </div>
                <span style="color:red; font-size:20px;" onclick="removeFromCart(${index})">ğŸ—‘ï¸</span>
            </div>
        `).join('');
        
        const total = cart.reduce((acc, curr) => acc + (parseInt(curr.price.replace(/[^0-9]/g,'')) || 0), 0);
        document.getElementById('totalPrice').innerText = total.toLocaleString();
    }

    function removeFromCart(index) {
        cart.splice(index, 1);
        document.getElementById('cartBadge').innerText = cart.length;
        updateCartDisplay();
    }

    function filterProducts() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const filtered = allProducts.filter(p => p.name.toLowerCase().includes(query) || p.store.toLowerCase().includes(query));
        renderProducts(filtered);
    }

    function sendOrder() {
        const message = encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ÙÙŠØ±Ø§ Ù…ÙˆÙ„ ğŸ‘‘\n\n${cart.map(i => `â€¢ ${i.name} - ${i.price} (${i.store})`).join('\n')}\n\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('totalPrice').innerText} SDG\nØ±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ Ù„Ù„ØªØ­ÙˆÙŠÙ„: 2280384`);
        window.open(`https://wa.me/249967584275?text=${message}`);
    }

    loadViraMall();
</script>
</body>
</html>
