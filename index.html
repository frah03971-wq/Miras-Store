<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | THE ULTIMATE EXPERIENCE</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Cinzel:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --gold: #D4AF37;
            --dark-gold: #AA841D;
            --black: #0a0a0a;
            --white: #ffffff;
            --grey: #f4f4f4;
            --glass: rgba(255, 255, 255, 0.95);
            --shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            margin: 0;
            background-color: #fafafa;
            color: var(--black);
            font-family: 'Cairo', sans-serif;
            overflow-x: hidden;
            padding-bottom: 120px;
        }

        /* --- Luxury Entrance --- */
        #v-gate {
            position: fixed;
            inset: 0;
            background: var(--black);
            z-index: 999999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: 1.5s cubic-bezier(0.7, 0, 0.3, 1);
        }
        .v-shimmer {
            font-family: 'Cinzel', serif;
            font-size: clamp(40px, 10vw, 60px);
            color: var(--gold);
            letter-spacing: 15px;
            animation: v-glow 2.5s infinite;
            text-shadow: 0 0 30px rgba(212,175,55,0.5);
        }
        @keyframes v-glow { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.3; transform: scale(1.05); } }

        /* --- Header & Search --- */
        header {
            background: var(--glass);
            backdrop-filter: blur(20px);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10000;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        .h-logo {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            font-weight: 900;
            letter-spacing: 4px;
            background: linear-gradient(45deg, #000, var(--gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .search-area {
            padding: 15px 20px;
            background: #fff;
        }
        .v-search {
            width: 100%;
            padding: 15px 25px;
            border-radius: 20px;
            border: 1px solid #eee;
            background: #f8f8f8;
            font-family: 'Cairo';
            font-size: 14px;
            transition: 0.3s;
        }
        .v-search:focus { border-color: var(--gold); background: #fff; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }

        /* --- Section Titles --- */
        .v-tag {
            padding: 40px 25px 15px;
            font-weight: 900;
            font-size: clamp(20px, 5vw, 26px);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .v-tag span { color: var(--gold); }
        .v-tag::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(to left, var(--gold), transparent);
        }

        /* --- Grid & Professional Card --- */
        .v-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
        }
        @media (max-width: 400px) { .v-grid { grid-template-columns: 1fr; } }

        .v-card {
            background: var(--white);
            border-radius: 40px;
            overflow: hidden;
            position: relative;
            border: 1px solid #f0f0f0;
            box-shadow: var(--shadow);
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Advanced Image Slider */
        .v-slider {
            width: 100%;
            height: 320px;
            position: relative;
            overflow: hidden;
            background: #f0f0f0;
        }
        .v-slides-container {
            display: flex;
            width: 100%;
            height: 100%;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .v-slides-container::-webkit-scrollbar { display: none; }
        .v-slides-container img {
            min-width: 100%;
            height: 100%;
            object-fit: cover;
            scroll-snap-align: start;
            cursor: zoom-in;
            transition: 0.5s;
        }

        .slider-nav {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
            z-index: 10;
        }
        .v-dot { width: 8px; height: 8px; background: rgba(255,255,255,0.4); border-radius: 50%; transition: 0.3s; }
        .v-dot.active { background: var(--gold); transform: scale(1.3); }

        .price-badge {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0,0,0,0.8);
            color: var(--gold);
            padding: 8px 16px;
            border-radius: 15px;
            font-weight: 900;
            font-size: 12px;
            z-index: 20;
            border: 1px solid var(--gold);
            backdrop-filter: blur(10px);
        }

        .v-info { padding: 25px; text-align: center; }
        .st-name { font-size: 10px; color: var(--gold); font-weight: 900; text-transform: uppercase; margin-bottom: 8px; display: block; letter-spacing: 2px; }
        .pr-title { font-size: clamp(15px, 4vw, 17px); font-weight: 700; height: 48px; overflow: hidden; margin-bottom: 12px; line-height: 1.4; color: #111; }
        .shipping-tag { font-size: 10px; color: #999; display: block; margin-bottom: 15px; border-top: 1px solid #f8f8f8; padding-top: 10px; font-weight: 600; }
        
        .v-buy-btn {
            background: var(--black);
            color: var(--gold);
            border: none;
            width: 100%;
            padding: 18px;
            border-radius: 22px;
            font-weight: 900;
            font-size: 13px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: 0.3s;
        }
        .v-buy-btn:active { transform: scale(0.95); }

        /* --- Fullscreen Viewer --- */
        #viewer {
            display: none;
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 9999999;
            justify-content: center;
            align-items: center;
        }
        #viewer img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .close-v { position: absolute; top: 40px; right: 40px; color: #fff; font-size: 40px; cursor: pointer; }

        /* --- Floating Nav --- */
        nav {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(25px);
            border-radius: 100px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 15px;
            border: 1px solid #eee;
            z-index: 50000;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }
        .n-icon { font-size: 24px; color: #bbb; position: relative; cursor: pointer; }
        .n-center {
            background: var(--black);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: -75px;
            border: 8px solid #fff;
            color: var(--gold);
            font-family: 'Cinzel';
            font-size: 38px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }
        .n-badge {
            position: absolute;
            top: -8px;
            right: -12px;
            background: #ff4757;
            color: #fff;
            font-size: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 900;
            border: 2px solid #fff;
        }

        /* --- Cart Modal --- */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 60000;
            backdrop-filter: blur(10px);
        }
        .modal-body {
            background: #fff;
            width: 92%;
            max-width: 480px;
            margin: 60px auto;
            border-radius: 45px;
            padding: 35px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #f5f5f5;
        }
    </style>
</head>
<body>

<div id="v-gate">
    <div class="v-shimmer">VIRA</div>
</div>

<header>
    <div style="font-size:22px; color:var(--gold);">üëë</div>
    <div class="h-logo">VIRA MALL</div>
    <div style="font-size:24px;" onclick="openCart()">üõí</div>
</header>

<div class="search-area">
    <input type="text" class="v-search" id="vSearch" placeholder="ÿßÿ®ÿ≠ÿ´Ÿä ÿπŸÜ ŸÖŸÜÿ™ÿ¨ÿå ŸÖÿ™ÿ¨ÿ±ÿå ÿ£Ÿà ŸÅÿ¶ÿ©..." oninput="mallSearch()">
</div>

<div class="v-tag">üíé <span>VIRA</span> PRIV√â</div>
<div id="viraGrid" class="v-grid"></div>

<div class="v-tag">üõçÔ∏è <span>GLOBAL</span> PARTNERS</div>
<div id="partnerGrid" class="v-grid"></div>

<div id="viewer">
    <span class="close-v" onclick="this.parentElement.style.display='none'">√ó</span>
    <img id="viewImg">
</div>

<div id="cartModal" class="modal" onclick="this.style.display='none'">
    <div class="modal-body" onclick="event.stopPropagation()">
        <h2 style="text-align:center; font-weight:900;">ÿ≠ŸÇŸäÿ®ÿ© ÿßŸÑÿ™ÿ≥ŸàŸÇ üõçÔ∏è</h2>
        <div id="cartContent"></div>
        <div style="text-align:center; margin-top:30px; border-top:2px solid #f9f9f9; pt-20">
            <h1 id="totalSdg" style="font-size:45px; color:var(--gold); margin:10px 0;">0</h1>
            <p style="font-size:12px; color:#999; margin-bottom:20px;">ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä ÿ¥ÿßŸÖŸÑ ÿßŸÑÿ™ŸÜÿ≥ŸäŸÇ</p>
            <button class="v-buy-btn" style="padding:22px;" onclick="sendWhatsApp()">ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ŸÑŸÑÿ•ÿØÿßÿ±ÿ© ‚úÖ</button>
        </div>
    </div>
</div>

<nav>
    <div class="n-icon" onclick="location.reload()">üè†</div>
    <div class="n-icon" onclick="openCart()">üíº<span class="n-badge" id="cCount">0</span></div>
    <div class="n-center">V</div>
    <div class="n-icon" onclick="alert('ÿ≠ÿ≥ÿßÿ® ÿ•Ÿäÿ´ÿßÿ± ÿ¥ÿ±ŸÅ ÿßŸÑÿØŸäŸÜ: 2280384')">üëë</div>
</nav>

<script>
    const S_ID = '1UZnlp45dVMRJxNibcg3fm52H6S4DB4YbGLr4KK3jPqs';
    let masterData = [];
    let cart = [];

    async function startup() {
        try {
            const [vR, pR] = await Promise.all([
                fetch(`https://docs.google.com/spreadsheets/d/${S_ID}/export?format=csv&gid=0`),
                fetch(`https://docs.google.com/spreadsheets/d/${S_ID}/export?format=csv&gid=1152504859`)
            ]);
            
            const vText = await vR.text();
            const pText = await pR.text();

            const parseV = (csv) => csv.split('\n').slice(1).map(row => {
                const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                return { store: 'VIRA', name: c[0], price: c[1], img: c[3]?.replace(/"/g,''), desc: c[4] };
            }).filter(i => i.name && i.img);

            const parseP = (csv) => csv.split('\n').slice(1).map(row => {
                const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(x => x?.replace(/"/g,'').trim());
                // Mapping: B:Store(1), D:Name(3), E:Price(4), F:Image(5)
                return { store: c[1], name: c[3], price: c[4], img: c[5], desc: c[6] };
            }).filter(i => i.name && i.img).reverse();

            masterData = [...parseV(vText), ...parseP(pText)];
            displayProducts(masterData);
            
            setTimeout(() => { document.getElementById('v-gate').style.opacity='0'; setTimeout(()=>document.getElementById('v-gate').remove(), 1000); }, 1500);
        } catch (err) { console.error("Sync Error"); }
    }

    function displayProducts(data) {
        let vHtml = '', pHtml = '';
        data.forEach((p, pIdx) => {
            // ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ±Ÿàÿßÿ®ÿ∑ ÿßŸÑŸÖÿ™ÿπÿØÿØÿ© (ÿµŸàÿ± ÿßŸÑÿ™ÿßÿ¨ÿ±ÿ©)
            const links = p.img.split(/[\s,]+/).filter(l => l.startsWith('http'));
            
            const card = `
                <div class="v-card">
                    <div class="price-badge">${p.price}</div>
                    <div class="v-slider">
                        <div class="v-slides-container" onscroll="updateDots(this, ${pIdx})">
                            ${links.map(l => `<img src="${l}" onclick="zoom('${l}')" onerror="this.src='https://placehold.jp/30/0a0a0a/d4af37/400x600.png?text=VIRA'">`).join('')}
                        </div>
                        <div class="slider-nav" id="dots-${pIdx}">
                            ${links.map((_, i) => `<div class="v-dot ${i===0?'active':''}"></div>`).join('')}
                        </div>
                    </div>
                    <div class="v-info">
                        <span class="st-name">${p.store}</span>
                        <div class="pr-title">${p.name}</div>
                        <span class="shipping-tag">üöö ÿßŸÑÿ™ŸàÿµŸäŸÑ Ÿäÿ™ŸÖ ÿπÿ®ÿ± ÿßŸÑŸÖÿ™ÿ¨ÿ±</span>
                        <button class="v-buy-btn" onclick="addCart('${p.name.replace(/'/g,"")}')">ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑÿ≠ŸÇŸäÿ®ÿ© üõí</button>
                    </div>
                </div>`;
            if(p.store === 'VIRA') vHtml += card; else pHtml += card;
        });
        document.getElementById('viraGrid').innerHTML = vHtml;
        document.getElementById('partnerGrid').innerHTML = pHtml;
    }

    function updateDots(el, idx) {
        const scrollIndex = Math.round(el.scrollLeft / el.offsetWidth);
        const dots = document.querySelectorAll(`#dots-${idx} .v-dot`);
        dots.forEach((dot, i) => {
            dot.classList.toggle('active', i === Math.abs(scrollIndex));
        });
    }

    function zoom(url) {
        document.getElementById('viewImg').src = url;
        document.getElementById('viewer').style.display = 'flex';
    }

    function mallSearch() {
        const q = document.getElementById('vSearch').value.toLowerCase();
        const filtered = masterData.filter(p => p.name.toLowerCase().includes(q) || p.store.toLowerCase().includes(q));
        displayProducts(filtered);
    }

    function addCart(name) {
        const item = masterData.find(x => x.name.replace(/'/g,"") === name);
        cart.push(item);
        document.getElementById('cCount').innerText = cart.length;
        // Animation
        const btn = event.target;
        btn.innerText = 'ÿ™ŸÖÿ™ ÿßŸÑÿ•ÿ∂ÿßŸÅÿ© ‚úÖ';
        setTimeout(() => btn.innerText = 'ÿ•ÿ∂ÿßŸÅÿ© ŸÑŸÑÿ≠ŸÇŸäÿ®ÿ© üõí', 1500);
    }

    function openCart() {
        if(!cart.length) return alert('ÿßŸÑÿ≠ŸÇŸäÿ®ÿ© ŸÅÿßÿ±ÿ∫ÿ©ÿå ÿ™ÿ≥ŸàŸÇŸä ÿßŸÑÿ¢ŸÜ ‚ú®');
        const box = document.getElementById('cartContent');
        box.innerHTML = cart.map((i, idx) => `
            <div class="cart-item">
                <div style="font-size:14px;"><b>${i.name}</b><br><small style="color:var(--gold)">${i.store}</small></div>
                <div style="font-weight:900;">${i.price} <span style="color:red; margin-right:15px;" onclick="removeFromCart(${idx})">√ó</span></div>
            </div>`).join('');
        
        const total = cart.reduce((acc, curr) => acc + (parseInt(curr.price.toString().replace(/[^0-9]/g,'')) || 0), 0);
        document.getElementById('totalSdg').innerText = total.toLocaleString() + ' SDG';
        document.getElementById('cartModal').style.display = 'block';
    }

    function removeFromCart(idx) {
        cart.splice(idx, 1);
        document.getElementById('cCount').innerText = cart.length;
        if(cart.length > 0) openCart(); else document.getElementById('cartModal').style.display = 'none';
    }

    function sendWhatsApp() {
        const text = encodeURIComponent(`ÿ∑ŸÑÿ® ÿ¨ÿØŸäÿØ - VIRA MALL üëë\n\n${cart.map(i => `‚Ä¢ ${i.name} [${i.store}]`).join('\n')}\n\nÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä: ${document.getElementById('totalSdg').innerText}`);
        window.open(`https://wa.me/249967584275?text=${text}`);
    }

    startup();
</script>
</body>
</html>
