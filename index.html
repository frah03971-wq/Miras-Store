<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VIRA MALL | THE EMPIRE</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=Cinzel+Decorative:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        :root { --gold: #D4AF37; --black: #000; --card-bg: #0d0d0d; --glass: rgba(10, 10, 10, 0.95); }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; scroll-behavior: smooth; }
        body { margin: 0; background: var(--black); color: #fff; font-family: 'Cairo', sans-serif; overflow-x: hidden; padding-bottom: 120px; }

        /* Ù„ÙˆØ¯Ø± ÙØ®Ø§Ù…Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚Ø© */
        #loading-screen { position: fixed; inset: 0; background: #000; z-index: 999999; display: flex; justify-content: center; align-items: center; transition: 1.2s cubic-bezier(0.7, 0, 0.3, 1); }
        .logo-glow { font-family: 'Cinzel Decorative'; font-size: 50px; color: var(--gold); letter-spacing: 12px; animation: glow 2s infinite; }
        @keyframes glow { 0%, 100% { opacity: 1; filter: drop-shadow(0 0 20px var(--gold)); } 50% { opacity: 0.3; } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        header { position: sticky; top: 0; z-index: 10000; padding: 25px; background: var(--glass); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(212,175,55,0.2); display: flex; justify-content: space-between; align-items: center; }
        .h-brand { font-family: 'Cinzel Decorative'; font-size: 28px; color: var(--gold); }

        /* Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø°ÙƒÙŠ */
        .search-area { padding: 20px; }
        .smart-input { width: 100%; padding: 20px; border-radius: 25px; border: 1px solid #222; background: #111; color: #fff; font-family: 'Cairo'; text-align: center; font-size: 16px; transition: 0.4s; }
        .smart-input:focus { border-color: var(--gold); background: #151515; box-shadow: 0 0 30px rgba(212,175,55,0.1); }

        /* Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section-tag { padding: 45px 25px 15px; font-weight: 900; font-size: 26px; color: var(--gold); display: flex; align-items: center; gap: 15px; }
        .section-tag::after { content: ''; flex: 1; height: 1px; background: linear-gradient(to left, var(--gold), transparent); }

        /* Ø§Ù„Ø´Ø¨ÙƒØ© (Grid) */
        .main-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px; padding: 18px; }
        @media (max-width: 500px) { .main-grid { grid-template-columns: 1fr; } }

        /* ÙƒØ±Øª Ø§Ù„Ø¹Ø±Ø¶ (The Master Card) */
        .v-card { background: var(--card-bg); border-radius: 35px; overflow: hidden; border: 1px solid #1a1a1a; position: relative; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .v-card:hover { border-color: var(--gold); transform: translateY(-10px); }

        .image-engine { width: 100%; height: 420px; position: relative; overflow: hidden; background: #000; }
        .slider-track { display: flex; width: 100%; height: 100%; overflow-x: auto; scroll-snap-type: x mandatory; scrollbar-width: none; }
        .slider-track::-webkit-scrollbar { display: none; }
        .slider-track img { min-width: 100%; height: 100%; object-fit: cover; scroll-snap-align: start; cursor: zoom-in; }

        .price-badge { position: absolute; top: 25px; left: 0; background: var(--gold); color: #000; padding: 8px 22px; border-radius: 0 20px 20px 0; font-weight: 900; font-size: 15px; z-index: 10; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        
        .dot-container { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 6px; }
        .v-dot { width: 7px; height: 7px; background: rgba(255,255,255,0.3); border-radius: 50%; transition: 0.3s; }
        .v-dot.active { background: var(--gold); width: 22px; border-radius: 10px; }

        .card-details { padding: 25px; text-align: center; }
        .store-label { font-size: 10px; color: var(--gold); font-weight: 900; letter-spacing: 3px; display: block; margin-bottom: 10px; text-transform: uppercase; opacity: 0.8; }
        .item-title { font-size: 19px; font-weight: 700; color: #fff; height: 54px; overflow: hidden; margin-bottom: 20px; line-height: 1.4; }
        
        .action-btn { background: #fff; color: #000; border: none; width: 100%; padding: 18px; border-radius: 20px; font-weight: 900; font-size: 15px; cursor: pointer; transition: 0.3s; box-shadow: 0 10px 20px rgba(255,255,255,0.05); }
        .action-btn:active { transform: scale(0.9); background: var(--gold); }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„Ø²ÙˆÙˆÙ… ÙˆØ§Ù„Ø³Ù„Ø© */
        #zoom-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 1000000; justify-content: center; align-items: center; }
        #cart-panel { display: none; position: fixed; inset: 0; background: #000; z-index: 500000; padding: 40px 25px; overflow-y: auto; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
        nav { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 88%; max-width: 420px; background: rgba(255,255,255,0.06); backdrop-filter: blur(30px); border-radius: 100px; display: flex; justify-content: space-around; padding: 15px; border: 1px solid rgba(255,255,255,0.1); z-index: 400000; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        .nav-link { font-size: 26px; color: #444; cursor: pointer; position: relative; transition: 0.3s; }
        .nav-link.active { color: var(--gold); }
        .badge { position: absolute; top: -10px; right: -12px; background: var(--gold); color: #000; font-size: 10px; width: 20px; height: 20px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: 900; border: 2px solid #000; }
    </style>
</head>
<body>

<div id="loading-screen"><div class="logo-glow">VIRA</div></div>

<header>
    <div style="font-size:12px; color:var(--gold); font-weight:900; letter-spacing:2px;">PLATFORM 2026</div>
    <div class="h-brand">VIRA</div>
    <div onclick="toggleCart()" style="font-size:24px;">ğŸ›’</div>
</header>

<div class="search-area">
    <input type="text" class="smart-input" id="searchBar" placeholder="Ø§Ø¨Ø­Ø«ÙŠ Ø¹Ù† Ø§Ù„Ø¬Ù…Ø§Ù„ØŒ Ø§Ù„Ù…ØªØ§Ø¬Ø±ØŒ Ø£Ùˆ Ø§Ù„Ø¹Ø·Ø§Ø±Ø©..." oninput="searchEngine()">
</div>

<div class="section-tag">âšœï¸ VIRA <span>EXCLUSIVE</span></div>
<div id="gridVira" class="main-grid"></div>

<div class="section-tag" style="color:#8c6a2c;">ğŸº HERITAGE <span>Ø¹Ø·Ø§Ø±Ø© Ø´Ø¹Ø¨ÙŠØ©</span></div>
<div id="gridHeritage" class="main-grid"></div>

<div class="section-tag">ğŸ›ï¸ PARTNER <span>STORES</span></div>
<div id="gridPartners" class="main-grid"></div>

<div id="zoom-overlay" onclick="this.style.display='none'"><img id="zImg" style="max-width:92%; max-height:80%; border:1px solid var(--gold); border-radius:15px;"></div>

<div id="cart-panel">
    <h1 style="color:var(--gold); text-align:center; font-family:'Cinzel Decorative'; font-size:35px;">THE BAG</h1>
    <div id="cartContent"></div>
    <div style="text-align:center; margin-top:60px;">
        <p style="color:#444; letter-spacing:5px;">SUBTOTAL</p>
        <h1 id="totalSdg" style="font-size:55px; margin:10px 0;">0</h1>
        <button class="action-btn" style="background:var(--gold); padding:22px; font-size:18px;" onclick="checkout()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ (ÙˆØ§ØªØ³Ø§Ø¨) âš¡</button>
        <p onclick="toggleCart()" style="margin-top:30px; color:#555; text-decoration:underline;">Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø­Ù‚ÙŠØ¨Ø©</p>
    </div>
</div>

<nav>
    <div class="nav-link" onclick="location.reload()">ğŸ </div>
    <div class="nav-link" onclick="toggleCart()">ğŸ’¼<span class="badge" id="cartCount">0</span></div>
    <div class="nav-link" onclick="alert('VIRA EMPIRE ADMIN 2026')">âš™ï¸</div>
</nav>

<script>
    const SHEET_ID = '1UZnlp45dVMRJxNibcg3fm52H6S4DB4YbGLr4KK3jPqs';
    let masterDB = [];
    let cart = [];

    async function launchEmpire() {
        try {
            const [respV, respP] = await Promise.all([
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`),
                fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=1152504859`)
            ]);
            
            const parse = (csv, isV) => csv.split('\n').slice(1).map(row => {
                const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(x => x?.replace(/"/g,'').trim());
                // Ù…Ø¨Ø±Ù…Ø¬ Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø¹Ù„Ù‰ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ÙÙˆØ±Ù…: B(1) Ø§Ù„Ù…ØªØ¬Ø±ØŒ D(3) Ø§Ù„Ù…Ù†ØªØ¬ØŒ E(4) Ø§Ù„Ø³Ø¹Ø±ØŒ F(5) Ø§Ù„ØµÙˆØ±ØŒ G(6) Ø§Ù„ÙˆØµÙ
                if(isV) return { store: 'VIRA', name: c[0], price: c[1], img: c[3], desc: c[4] };
                return { 
                    store: c[1] || 'Ù…ØªØ¬Ø± ÙÙŠØ±Ø§', 
                    name: c[3] || '', 
                    price: c[4] || '0', 
                    img: c[5] || '', 
                    desc: c[6] || '' 
                };
            }).filter(i => i.name && i.img);

            masterDB = [...parse(await respV.text(), true), ...parse(await respP.text(), false).reverse()];
            renderGrid(masterDB);
            
            setTimeout(() => { document.getElementById('loading-screen').style.transform = 'translateY(-100%)'; }, 1500);
        } catch (e) { alert("ØªØ£ÙƒØ¯ÙŠ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙŠØ§ Ù…Ù„ÙƒØ©"); }
    }

    function renderGrid(data) {
        let hV = '', hP = '', hH = '';
        data.forEach((p, idx) => {
            // Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø¹Ø¬Ø²Ø© Ù„Ù„Ø±ÙˆØ§Ø¨Ø· (Ù…Ø³Ø§ÙØ§ØªØŒ Ø£Ø³Ø·Ø±ØŒ ÙÙˆØ§ØµÙ„)
            const cleanLinks = p.img.split(/[,\s\n\t]+/).filter(l => l.includes('http'));
            const dots = cleanLinks.length > 1 ? `<div class="dot-container" id="dots-${idx}">${cleanLinks.map((_,i)=>`<div class="v-dot ${i===0?'active':''}"></div>`).join('')}</div>` : '';

            const card = `
                <div class="v-card">
                    <div class="price-badge">${p.price}</div>
                    <div class="image-engine">
                        <div class="slider-track" onscroll="syncDots(this, ${idx})">
                            ${cleanLinks.map(l => `<img src="${l}" onclick="zoom('${l}')">`).join('')}
                        </div>
                        ${dots}
                    </div>
                    <div class="card-details">
                        <span class="store-label">${p.store}</span>
                        <div class="item-title">${p.name}</div>
                        <button class="action-btn" onclick="addToCart('${p.name.replace(/'/g,"")}')">Ø§Ù‚ØªÙ†Ø§Ø¡ Ø§Ù„Ø¢Ù† âœ¨</button>
                    </div>
                </div>`;
            
            const isHeritage = p.name.includes('Ø¹Ø·Ø§Ø±Ø©') || p.store.includes('Ø¹Ø·Ø§Ø±Ø©') || p.desc.includes('Ø¹Ø·Ø§Ø±Ø©');

            if(p.store === 'VIRA') hV += card;
            else if(isHeritage) hH += card;
            else hP += card;
        });
        document.getElementById('gridVira').innerHTML = hV;
        document.getElementById('gridHeritage').innerHTML = hH;
        document.getElementById('partnerGrid').innerHTML = hP;
    }

    function syncDots(el, idx) {
        const i = Math.round(el.scrollLeft / el.offsetWidth);
        const ds = document.querySelectorAll(`#dots-${idx} .v-dot`);
        ds.forEach((d, n) => d.classList.toggle('active', n === Math.abs(i)));
    }

    function zoom(l) { document.getElementById('zImg').src = l; document.getElementById('zoom-overlay').style.display = 'flex'; }

    function searchEngine() {
        const q = document.getElementById('searchBar').value.toLowerCase();
        renderGrid(masterDB.filter(p => p.name.toLowerCase().includes(q) || p.store.toLowerCase().includes(q)));
    }

    function addToCart(n) {
        cart.push(masterDB.find(x => x.name.replace(/'/g,"") === n));
        document.getElementById('cartCount').innerText = cart.length;
        const btn = event.target; btn.innerText = 'Ø£Ø¶ÙŠÙ Ù„Ù…Ù‚ØªÙ†ÙŠØ§ØªÙƒ ğŸ–¤';
        setTimeout(() => btn.innerText = 'Ø§Ù‚ØªÙ†Ø§Ø¡ Ø§Ù„Ø¢Ù† âœ¨', 1000);
    }

    function toggleCart() {
        const p = document.getElementById('cart-panel');
        p.style.display = (p.style.display === 'block') ? 'none' : 'block';
        if(p.style.display === 'block') {
            document.getElementById('cartContent').innerHTML = cart.map((i, idx) => `
                <div style="display:flex; justify-content:space-between; padding:20px 0; border-bottom:1px solid #111;">
                    <div><b>${i.name}</b><br><small style="color:var(--gold)">${i.store}</small></div>
                    <div>${i.price} <span style="color:red; margin-right:20px; font-weight:bold" onclick="removeItem(${idx})">Ã—</span></div>
                </div>`).join('');
            const total = cart.reduce((a, c) => a + (parseInt(c.price.toString().replace(/[^0-9]/g,'')) || 0), 0);
            document.getElementById('totalSdg').innerText = total.toLocaleString() + ' SDG';
        }
    }

    function removeItem(idx) { cart.splice(idx, 1); document.getElementById('cartCount').innerText = cart.length; toggleCart(); toggleCart(); }

    function checkout() {
        const msg = encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - VIRA EMPIRE ğŸ‘‘\n\n${cart.map(i => `â€¢ ${i.name} [Ø§Ù„Ù…ØªØ¬Ø±: ${i.store}]`).join('\n')}\n\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('totalSdg').innerText}`);
        window.open(`https://wa.me/249967584275?text=${msg}`);
    }

    launchEmpire();
</script>
</body>
</html>
